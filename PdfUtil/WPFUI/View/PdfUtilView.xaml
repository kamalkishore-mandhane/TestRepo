<controls:BaseWindow x:Uid="PdfUtilViewWindow" x:Class="PdfUtil.WPFUI.View.PdfUtilView"
                     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                     xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                     xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                     xmlns:utl="clr-namespace:PdfUtil.WPFUI.Utils"
                     xmlns:controls="clr-namespace:PdfUtil.WPFUI.Controls"
                     xmlns:spl="clr-namespace:StartupPaneLib;assembly=StartupPaneLib"
                     mc:Ignorable="d"
                     Title="{Binding PDFTitle}"
                     Height="830"
                     Width="925"
                     MinWidth="688"
                     MinHeight="510"
                     ResizeMode="CanResize"
                     SnapsToDevicePixels="True"
                     Loaded="PdfUtilView_Loaded"
                     Unloaded="PdfUtilView_Unloaded"
                     Closed="PdfUtilView_Closed"
                     Closing="PdfUtilViewWindow_Closing"
                     LostKeyboardFocus="PdfUtilViewWindow_LostKeyboardFocus"
                     SizeChanged="PdfUtilViewWindow_SizeChanged"
                     KeyDown="PdfUtilViewWindow_KeyDown"
                     x:Name="PdfUtilViewWindow">

    <Window.Resources>
        <ResourceDictionary x:Uid="ResourceDictionary_1">

            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary x:Uid="ResourceDictionary_8">
                    <ResourceDictionary.MergedDictionaries>
                        <ResourceDictionary x:Uid="ResourceDictionary_9" Source="../Themes/WinZipColorTheme.xaml"/>
                    </ResourceDictionary.MergedDictionaries>
                </ResourceDictionary>

                <ResourceDictionary x:Uid="ResourceDictionary_2" Source="../Themes/SharedStyle.xaml"/>
                <ResourceDictionary x:Uid="ResourceDictionary_10" Source="../Themes/SharedGeometry.xaml"/>
                <ResourceDictionary x:Uid="ResourceDictionary_3" Source="../Themes/FlatScrollViewerStyle.xaml"/>
                <ResourceDictionary x:Uid="ResourceDictionary_4" Source="../Themes/ThumbnailPaneContextMenuStyle.xaml"/>
                <ResourceDictionary x:Uid="ResourceDictionary_5" Source="../Themes/BookmarkPaneContextMenuStyle.xaml"/>
                <ResourceDictionary x:Uid="ResourceDictionary_6" Source="../Themes/PreviewPaneContextMenuStyle.xaml"/>
                <ResourceDictionary x:Uid="ResourceDictionary_7" Source="../Themes/FakeRibbonControlsStyle.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <controls:ValueMultiplication x:Uid="controls:ValueMultiplication" x:Key="ValueMultiplication"/>
            <controls:ValueAddition x:Uid="controls:ValueAddition" x:Key="ValueAddition"/>
            <controls:IntToVisibilityConverter x:Uid="controls:IntToVisibilityValueConverter_2" x:Key="int2Vis"/>
            <controls:InvertBooleanToVisibilityConverter x:Uid="controls:InvertBooleanToVisibilityConverter_1" x:Key="invertBool2Vis"/>
            <controls:BoolToVisibilityValueConverter x:Uid="controls:BoolToVisibilityValueConverter_1" x:Key="bool2Vis"/>
            <controls:ItemSourceCountFilterConverter x:Uid="controls:ItemSourceCountFilterConverter_1" x:Key="ItemSourceCountFilter"/>
            <controls:StringToVisibilityConverter x:Uid="ctrl:StringToVisibilityConverter_1" x:Key="string2VisInvert" Invert="True" />
            <controls:Bool2VisibilityMultiConverter x:Uid="controls:Bool2VisibilityMultiConverter_1" x:Key="bool2VisMulti" AndOperation="True"/>

            <Style x:Uid="Style_1" x:Key="PdfUtilView.Shared.TextBlockStyle.SegoeUI.SemiBold.15px" TargetType="{x:Type TextBlock}">
                <Setter x:Uid="Setter_1" Property="FontFamily" Value="{StaticResource Shared.FontFamily.SegoeUI}"/>
                <Setter x:Uid="Setter_2" Property="FontWeight" Value="{StaticResource Shared.FontWeight.SemiBold}"/>
                <Setter x:Uid="Setter_3" Property="FontSize" Value="{StaticResource Shared.FontSize.15px}"/>
            </Style>

            <Style x:Uid="Style_2" x:Key="TitileTextBlockStyle" TargetType="{x:Type TextBlock}">
                <Setter x:Uid="Setter_4" Property="Height" Value="{StaticResource Shared.FontSize.22px}"/>
                <Setter x:Uid="Setter_5" Property="VerticalAlignment" Value="Top"/>
                <Setter x:Uid="Setter_6" Property="HorizontalAlignment" Value="Left"/>
                <Setter x:Uid="Setter_7" Property="TextTrimming" Value="CharacterEllipsis"/>
                <Setter x:Uid="Setter_8" Property="FontFamily" Value="{StaticResource Shared.FontFamily.SegoeUI}"/>
                <Setter x:Uid="Setter_9" Property="FontWeight" Value="{DynamicResource Shared.FontWeight.Bold}"/>
                <Setter x:Uid="Setter_10" Property="FontSize" Value="{StaticResource Shared.FontSize.16px}"/>
                <Setter x:Uid="Setter_11" Property="Foreground" Value="{DynamicResource Brush.Title}"/>
            </Style>

            <Style x:Uid="Style_3" x:Key="PrimaryTextBlockStyle" BasedOn="{StaticResource PdfUtilView.Shared.TextBlockStyle.SegoeUI.SemiBold.15px}" TargetType="{x:Type TextBlock}">
                <Setter x:Uid="Setter_12" Property="HorizontalAlignment" Value="Center"/>
                <Setter x:Uid="Setter_13" Property="VerticalAlignment" Value="Center"/>
                <Setter x:Uid="Setter_14" Property="TextAlignment" Value="Center"/>
                <Setter x:Uid="Setter_15" Property="TextTrimming" Value="CharacterEllipsis"/>
                <Setter x:Uid="Setter_16" Property="Height" Value="{StaticResource Shared.FontSize.15px.Height.20}"/>
                <Setter x:Uid="Setter_18" Property="Foreground" Value="{DynamicResource Brush.Text.Foreground}"/>
            </Style>

            <Style x:Uid="Style_4" x:Key="BaseListViewStyle"
                   TargetType="{x:Type ListView}"
                   BasedOn="{StaticResource {x:Type ListBox}}">
                <Setter x:Uid="Setter_19" Property="VirtualizingStackPanel.IsVirtualizing" Value="True" />
                <Setter x:Uid="Setter_20" Property="ScrollViewer.CanContentScroll" Value="True" />
                <Setter x:Uid="Setter_21" Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled" />
                <Setter x:Uid="Setter_22" Property="ScrollViewer.VerticalScrollBarVisibility" Value="Visible" />
                <Setter x:Uid="Setter_23" Property="SnapsToDevicePixels" Value="true" />
                <Setter x:Uid="Setter_24" Property="OverridesDefaultStyle" Value="true" />
            </Style>

            <!-- Icon View-->

            <Style x:Uid="Style_5" TargetType="utl:SnapsToDevicePixelsBitmap"
                   x:Key="SnapsToDevicePixelsBitmapStyle">
                <Setter x:Uid="Setter_25" Property="Opacity" Value="1" />
            </Style>

            <ControlTemplate x:Uid="ControlTemplate_1" x:Key="ListBoxItemIconViewControlTemplate">
                <Grid x:Uid="Grid_1"
                      HorizontalAlignment="Center"
                      Width="{Binding Path=DataContext.ThumbnailZoom, ElementName=PdfUtilViewWindow, Converter={StaticResource ValueMultiplication}, ConverterParameter='135'}"
                      Height="{Binding Path=DataContext.ThumbnailZoom, ElementName=PdfUtilViewWindow, Converter={StaticResource ValueMultiplication}, ConverterParameter='165'}">
                    <Grid.RowDefinitions>
                        <RowDefinition x:Uid="RowDefinition_2" Height="20" />
                        <RowDefinition x:Uid="RowDefinition_1" Height="*" />
                        <RowDefinition x:Uid="RowDefinition_18" Height="20" />
                    </Grid.RowDefinitions>

                    <controls:ThumbnailCheckBox x:Uid="itemCheckbox" x:Name="itemCheckbox" Grid.Row="0"
                                                HorizontalAlignment="Left"
                                                Style="{StaticResource FlatIconCheckBoxStyle}"
                                                IsChecked="{Binding Path=IsSelected, Mode=TwoWay, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListViewItem}}}"/>

                    <StackPanel x:Uid="StackPanel_1" Grid.Row="1"
                                VerticalAlignment="Top"
                                HorizontalAlignment="Center"
                                Orientation="Horizontal">
                        <Border x:Uid="Border_1" BorderBrush="{DynamicResource Brush.Item.Border}" BorderThickness="1">
                            <utl:SnapsToDevicePixelsBitmap x:Uid="itemImage" x:Name="itemImage"
                                                           Stretch="Uniform"
                                                           Source="{Binding Path=IconImage}"
                                                           Style="{StaticResource SnapsToDevicePixelsBitmapStyle}" />
                        </Border>
                    </StackPanel>

                    <Grid x:Uid="Grid_18" Grid.Row="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition x:Uid="ColumnDefinition_21" Width="1*"/>
                            <ColumnDefinition x:Uid="ColumnDefinition_22" Width="1*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock x:Uid="pageNumberextBox" x:Name="pageNumberextBox"
                                   Grid.Column="0"
                                   Grid.ColumnSpan="2"
                                   Style="{StaticResource PrimaryTextBlockStyle}"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Text="{Binding Path=Name}"/>

                        <StackPanel x:Uid="StackPanel_25"
                                    x:Name="CommentCountPanel"
                                    Orientation="Horizontal"
                                    Grid.Column="1"
                                    Margin="22,2,2,2"
                                    HorizontalAlignment="Left"
                                    Visibility="{Binding CommentCount, Converter={StaticResource int2Vis}}"
                                    Background="{DynamicResource Brush.Comment.Background.Gray}">
                            <Rectangle x:Uid="Rectangle_2"
                                       Width="10" Height="10"
                                       Margin="3,0"
                                       VerticalAlignment="Center"
                                       Fill="{StaticResource CommentTitleWhiteDrawingBrush}"/>
                            <TextBlock x:Uid="TextBlock_37"
                                       Margin="0,0,3,0"
                                       FontSize="11"
                                       VerticalAlignment="Center"
                                       Foreground="{DynamicResource Brush.Comment.Background.White}"
                                       Visibility="{Binding Path=DataContext.HideCommentCountInThumbnail, ElementName=PdfUtilViewWindow, Converter={StaticResource invertBool2Vis}}"
                                       Text="{Binding CommentCount}"/>
                        </StackPanel>
                    </Grid>
                </Grid>
            </ControlTemplate>

            <DataTemplate x:Uid="DataTemplate_1" x:Key="ListBoxIconViewDataTemplate"
                          DataType="ListViewItem">
                <Control x:Uid="Control_1" IsTabStop="False"
                         Loaded="OnThumbnailItemLoaded"
                         Unloaded="OnThumbnailItemUnloaded"
                         Template="{StaticResource ListBoxItemIconViewControlTemplate}" />
            </DataTemplate>

            <Style x:Uid="Style_6" x:Key="ListBoxItemIconViewStyle"
                   TargetType="{x:Type ListViewItem}">
                <Setter x:Uid="Setter_26" Property="FocusVisualStyle" Value="{x:Null}" />
                <Setter x:Uid="Setter_27" Property="SnapsToDevicePixels" Value="true" />
                <Setter x:Uid="Setter_28" Property="OverridesDefaultStyle" Value="True" />
                <Setter x:Uid="Setter_31" Property="Template">
                    <Setter.Value>
                        <ControlTemplate x:Uid="ControlTemplate_2" TargetType="{x:Type ListViewItem}">
                            <Grid x:Uid="Grid_2" HorizontalAlignment="Center" VerticalAlignment="Top">
                                <Grid.RowDefinitions>
                                    <RowDefinition x:Uid="RowDefinition_3" Height="24" />
                                    <RowDefinition x:Uid="RowDefinition_4" Height="Auto" />
                                    <RowDefinition x:Uid="RowDefinition_19" Height="24" />
                                </Grid.RowDefinitions>

                                <Rectangle  x:Uid="listBoxItemIconViewLine" x:Name="listBoxItemIconViewTopLine" Visibility="Hidden"
                                      Grid.Row="0"
                                      Height="2" Fill="{DynamicResource Brush.Item.SelectedBorder}"
                                      Width="{Binding Path=ActualWidth, ElementName=listBoxItemIconViewBorder, Converter={StaticResource ValueAddition}, ConverterParameter='8'}"/>
                                <utl:DragHilightBorder x:Uid="listBoxItemIconViewBorder" x:Name="listBoxItemIconViewBorder"
                                                       Grid.Row="1"
                                                       BorderThickness="2,1,2,3"
                                                       SnapsToDevicePixels="True"
                                                       HilightBackground="{DynamicResource Brush.Item.SelectedBackground}"
                                                       HilightBorderBrush="{DynamicResource Brush.Item.SelectedBorder}"
                                                       HilightEnable="True"
                                                       Margin="1,1,1,1"
                                                       HorizontalAlignment="Center" VerticalAlignment="Center"
                                                       BorderBrush ="Transparent">
                                    <ContentPresenter x:Uid="ContentPresenter_1" />
                                </utl:DragHilightBorder>
                                <Border x:Uid="previewSelectedBorder" x:Name="previewSelectedBorder"
                                        Grid.Row="1"
                                        VerticalAlignment="Center"
                                        Visibility="{Binding Path=IsPreviewSelected, Converter={StaticResource BoolToVisibility}}"
                                        Width="{Binding Path=ActualWidth, ElementName=listBoxItemIconViewBorder}"
                                        Height="{Binding Path=ActualHeight, ElementName=listBoxItemIconViewBorder}"
                                        BorderThickness="1">
                                    <Border.BorderBrush>
                                        <DrawingBrush x:Uid="DrawingBrush_1" Viewport="0,0,8,8" ViewportUnits="Absolute" TileMode="Tile">
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup x:Uid="DrawingGroup_1">
                                                    <GeometryDrawing x:Uid="GeometryDrawing_1" Brush="{DynamicResource Brush.Item.Border}">
                                                        <GeometryDrawing.Geometry>
                                                            <GeometryGroup x:Uid="GeometryGroup_1">
                                                                <RectangleGeometry x:Uid="RectangleGeometry_1" Rect="0,0,50,50" />
                                                                <RectangleGeometry x:Uid="RectangleGeometry_2" Rect="50,50,50,50" />
                                                            </GeometryGroup>
                                                        </GeometryDrawing.Geometry>
                                                    </GeometryDrawing>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Border.BorderBrush>
                                </Border>
                                <Rectangle  x:Uid="Rectangle_1" x:Name="listBoxItemIconViewLine" Visibility="Hidden"
                                      Grid.Row="2"
                                      Height="2" Fill="{DynamicResource Brush.Item.SelectedBorder}"
                                      Width="{Binding Path=ActualWidth, ElementName=listBoxItemIconViewBorder, Converter={StaticResource ValueAddition}, ConverterParameter='8'}"/>
                                <controls:Caret
                                    x:Uid="controls:Caret_1" Tag="firstCaret"
                                    Visibility="Hidden"
                                    Grid.Row="0"
                                    Focusable="False" VerticalAlignment="Top"
                                    Width="{Binding Path=ActualWidth, ElementName=listBoxItemIconViewBorder, Converter={StaticResource ValueAddition}, ConverterParameter='24'}">
                                </controls:Caret>

                                <Rectangle x:Uid="firstCaretSupport"
                                      Grid.Row="0"
                                      x:Name="firstCaretSupport"
                                      Focusable="False"
                                      Margin="0,0,0,0"
                                      Stroke="Transparent"
                                      Fill="Transparent"
                                      DragEnter="caretSupport_DragAndDrop"
                                      DragLeave="caretSupport_DragAndDrop"
                                      Drop="caretSupport_DragAndDrop"/>

                                <controls:Caret x:Uid="controls:Caret_2" Tag="caret"
                                    Visibility="Hidden"
                                    Grid.Row="2"
                                    Focusable="False" VerticalAlignment="Bottom"
                                    Width="{Binding Path=ActualWidth, ElementName=listBoxItemIconViewBorder, Converter={StaticResource ValueAddition}, ConverterParameter='24'}">
                                </controls:Caret>
                                <Rectangle x:Uid="CaretSupport" Visibility="Visible"
                                      Grid.Row="2"
                                      x:Name="caretSupport"
                                      Focusable="False"
                                      Margin="0,0,0,0"
                                      Stroke="Transparent"
                                      Fill="Transparent"
                                      DragEnter="caretSupport_DragAndDrop"
                                      DragLeave="caretSupport_DragAndDrop"
                                      Drop="caretSupport_DragAndDrop"/>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger x:Uid="Trigger_1" Property="IsMouseOver" Value="True" SourceName="listBoxItemIconViewBorder">
                                    <Setter x:Uid="Setter_32" TargetName="listBoxItemIconViewBorder"
                                            Property="Background"
                                            Value="{DynamicResource Brush.Item.HoverBackground}" />
                                    <Setter x:Uid="Setter_33" TargetName="listBoxItemIconViewBorder"
                                            Property="BorderBrush"
                                            Value="{DynamicResource Brush.Item.HoverBorder}" />
                                    <Setter x:Uid="Setter_34" TargetName="listBoxItemIconViewBorder"
                                            Property="BorderThickness"
                                            Value="1" />
                                </Trigger>
                                <Trigger x:Uid="Trigger_2" Property="IsSelected" Value="True">
                                    <Setter x:Uid="Setter_35" TargetName="listBoxItemIconViewBorder"
                                            Property="Background"
                                            Value="{DynamicResource Brush.Item.SelectedBackground}" />
                                    <Setter x:Uid="Setter_36" TargetName="listBoxItemIconViewBorder"
                                            Property="BorderBrush"
                                            Value="{DynamicResource Brush.Item.SelectedBorder}" />
                                    <Setter x:Uid="Setter_37" TargetName="listBoxItemIconViewBorder"
                                            Property="BorderThickness"
                                            Value="2" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Uid="Style_7" x:Key="ListViewIconViewStyle"
                   TargetType="{x:Type ListView}"
                   BasedOn="{StaticResource BaseListViewStyle}">
                <Setter x:Uid="Setter_38" Property="ItemContainerStyle"
                        Value="{StaticResource ListBoxItemIconViewStyle}" />
                <Setter x:Uid="Setter_39" Property="ItemTemplate"
                        Value="{StaticResource ListBoxIconViewDataTemplate}" />
                <Setter x:Uid="Setter_40" Property="Background" Value="Transparent" />
                <Setter x:Uid="Setter_41" Property="ItemsPanel">
                    <Setter.Value>
                        <ItemsPanelTemplate x:Uid="ItemsPanelTemplate_1" >
                            <utl:VirtualizingWrapPanel x:Uid="utl:VirtualizingWrapPanel_1"
                                                       x:Name="virtualizingWrapPanel"
                                                       IsItemsHost="True"
                                                       VerticalAlignment="Center"
                                                       HorizontalAlignment="Center">
                            </utl:VirtualizingWrapPanel>
                        </ItemsPanelTemplate>
                    </Setter.Value>
                </Setter>
                <Setter x:Uid="Setter_42" Property="Template">
                    <Setter.Value>
                        <ControlTemplate x:Uid="ControlTemplate_3">
                            <Border x:Uid="Border_2" BorderThickness="0">
                                <controls:FlatScrollViewer x:Uid="controls:FlatScrollViewer_1"
                                                           Style="{StaticResource flatScrollViewer}"
                                                           x:Name="listViewScroller"
                                                           VerticalScrollBarVisibility="Auto"
                                                           HorizontalScrollBarVisibility="Disabled">
                                    <ItemsPresenter x:Uid="ItemsPresenter_1" />
                                </controls:FlatScrollViewer>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <EventSetter x:Uid="EventSetter_1" Event="PreviewMouseDown" Handler="ListViewItem_PreviewMouseDown"/>
            </Style>
            <!-- Icon View-->

            <Style x:Uid="Style_8" x:Key="TabItemStyle"
               TargetType="{x:Type TabItem}">
                <Setter x:Uid="Setter_43" Property="Height" Value="22"/>
                <Setter x:Uid="Setter_44" Property="MinWidth" Value="80"/>
                <Setter x:Uid="Setter_45" Property="Template">
                    <Setter.Value>
                        <ControlTemplate x:Uid="ControlTemplate_4" TargetType="TabItem">
                            <Border x:Uid="Border" x:Name="Border"
                                    BorderThickness="1,0,1,1"
                                    Margin="0,0,-1,0"
                                    BorderBrush="{DynamicResource Brush.Item.Border}"
                                    Background="{DynamicResource Brush.Background.Gray}"
                                    SnapsToDevicePixels="True">
                                <Border x:Uid="TabItemBorder" x:Name="TabItemBorder"
                                        Background="Transparent"
                                        BorderBrush="Transparent"
                                        BorderThickness="1"
                                        Padding="5,0,5,0">
                                    <ContentPresenter x:Uid="ContentSite" x:Name="ContentSite"
                                                      ContentSource="Header"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"/>
                                </Border>
                            </Border>
                            <ControlTemplate.Triggers>
                                <MultiTrigger x:Uid="MultiTrigger_1" >
                                    <MultiTrigger.Conditions>
                                        <Condition x:Uid="Condition_1" Property="IsSelected" Value="False" />
                                        <Condition x:Uid="Condition_2" Property="IsMouseOver" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <Setter x:Uid="Setter_46" TargetName="TabItemBorder" Property="Background"
                                            Value="{DynamicResource Brush.Item.HoverBackground}" />
                                    <Setter x:Uid="Setter_47" TargetName="TabItemBorder" Property="BorderBrush"
                                            Value="{DynamicResource Brush.Item.HoverBorder}" />
                                </MultiTrigger>
                                <Trigger x:Uid="Trigger_3" Property="IsSelected" Value="True">
                                    <Trigger.Setters>
                                        <Setter x:Uid="Setter_48" TargetName="Border"
                                                Property="Background"
                                                Value="{DynamicResource Brush.FakeRibbonApplicationMenuButton.Background}" />
                                        <Setter x:Uid="Setter_49" TargetName="Border"
                                                Property="BorderThickness"
                                                Value="1,0,1,0" />
                                    </Trigger.Setters>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <ControlTemplate x:Uid="ControlTemplate_5" x:Key="ButtonTemplate" TargetType="Button">
                <Border x:Uid="Border_3" CornerRadius="0" BorderThickness="1" SnapsToDevicePixels="True"
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}">
                    <ContentPresenter x:Uid="ContentPresenter_2" HorizontalAlignment="Stretch" VerticalAlignment="Center"/>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger x:Uid="Trigger_4" Property="IsMouseOver" Value="True">
                        <Setter x:Uid="Setter_50" Property="Background" Value="{DynamicResource Brush.Item.HoverBackground}"/>
                        <Setter x:Uid="Setter_51" Property="BorderBrush" Value="{DynamicResource Brush.Item.HoverBorder}"/>
                    </Trigger>
                    <Trigger x:Uid="Trigger_5" Property="IsPressed" Value="True">
                        <Setter x:Uid="Setter_52" Property="Background" Value="{DynamicResource Brush.Item.SelectedBackground}"/>
                        <Setter x:Uid="Setter_53" Property="BorderBrush" Value="{DynamicResource Brush.Item.SelectedBorder}"/>
                    </Trigger>
                    <Trigger x:Uid="Trigger_6" Property="IsKeyboardFocused" Value="True">
                        <Setter x:Uid="Setter_54" Property="BorderBrush" Value="{DynamicResource Brush.TabFocusBorder}"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>

            <Style x:Uid="Style_9" x:Key="CommonButtonStyle" TargetType="{x:Type Button}">
                <Setter x:Uid="Setter_55" Property="Background" Value="{DynamicResource Brush.Background.Gray}"/>
                <Setter x:Uid="Setter_56" Property="Foreground" Value="{DynamicResource Brush.Item.Text.Black}"/>
                <Setter x:Uid="Setter_57" Property="BorderBrush" Value="{DynamicResource Brush.Item.Border}"/>
                <Setter x:Uid="Setter_58" Property="FocusVisualStyle" Value="{x:Null}"/>
                <Setter x:Uid="Setter_59" Property="Template" Value="{StaticResource ButtonTemplate}"/>
            </Style>

            <ControlTemplate x:Uid="ControlTemplate_10" x:Key="LeftGridSplitterTemplate" TargetType="GridSplitter">
                <Border x:Uid="Border_4" CornerRadius="0"
                        BorderThickness="1,0,1,0"
                        SnapsToDevicePixels="True"
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}">
                    <StackPanel x:Uid="StackPanel_3" HorizontalAlignment="Center" VerticalAlignment="Center" Orientation="Vertical">
                        <Path x:Uid="Path_1" x:Name="contentPath"
                              VerticalAlignment="Center"
                              HorizontalAlignment="Center"
                              StrokeThickness="1"
                              Stroke="{DynamicResource Brush.FlatScrollViewer.RepeatButtonPathStroke}"
                              Fill="{DynamicResource Brush.FlatScrollViewer.RepeatButtonPathStroke}"
                              Data="M 3 0 L 0 3 L 3 6 L 3 0 Z"/>
                    </StackPanel>
                </Border>

                <ControlTemplate.Triggers>
                    <Trigger x:Uid="Trigger_7" Property="IsMouseOver" Value="True">
                        <Setter x:Uid="Setter_60" Property="Background" Value="{DynamicResource Brush.Item.HoverBackground}"/>
                    </Trigger>
                    <DataTrigger x:Uid="DataTrigger_3" Binding="{Binding Path=Visibility, ElementName=TabControlsStackGrid}" Value="Visible">
                        <Setter x:Uid="Setter_98" TargetName="contentPath" Property="Data" Value="M 3 0 L 0 3 L 3 6 L 3 0 Z"/>
                    </DataTrigger>
                    <DataTrigger x:Uid="DataTrigger_4" Binding="{Binding Path=Visibility, ElementName=TabControlsStackGrid}" Value="Collapsed">
                        <Setter x:Uid="Setter_99" TargetName="contentPath" Property="Data" Value="M 0 0 L 3 3 L 0 6 L 0 0 Z"/>
                    </DataTrigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>

            <ControlTemplate x:Uid="ControlTemplate_17" x:Key="RightGridSplitterTemplate" TargetType="GridSplitter">
                <Border x:Uid="Border_17" CornerRadius="0"
                        BorderThickness="1,0,1,0"
                        SnapsToDevicePixels="True"
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}">
                    <StackPanel x:Uid="StackPanel_26" HorizontalAlignment="Center" VerticalAlignment="Center" Orientation="Vertical">
                        <Path x:Uid="contentPath" x:Name="contentPath"
                              VerticalAlignment="Center"
                              HorizontalAlignment="Center"
                              StrokeThickness="1"
                              Stroke="{DynamicResource Brush.FlatScrollViewer.RepeatButtonPathStroke}"
                              Fill="{DynamicResource Brush.FlatScrollViewer.RepeatButtonPathStroke}"
                              Data="M 3 0 L 0 3 L 3 6 L 3 0 Z"/>
                    </StackPanel>
                </Border>

                <ControlTemplate.Triggers>
                    <Trigger x:Uid="Trigger_16" Property="IsMouseOver" Value="True">
                        <Setter x:Uid="Setter_149" Property="Background" Value="{DynamicResource Brush.Item.HoverBackground}"/>
                    </Trigger>
                    <DataTrigger x:Uid="DataTrigger_9" Binding="{Binding Path=Visibility, ElementName=CommentControlsGrid}" Value="Visible">
                        <Setter x:Uid="Setter_150" TargetName="contentPath" Property="Data" Value="M 0 0 L 3 3 L 0 6 L 0 0 Z"/>
                    </DataTrigger>
                    <DataTrigger x:Uid="DataTrigger_10" Binding="{Binding Path=Visibility, ElementName=CommentControlsGrid}" Value="Collapsed">
                        <Setter x:Uid="Setter_151" TargetName="contentPath" Property="Data" Value="M 3 0 L 0 3 L 3 6 L 3 0 Z"/>
                    </DataTrigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>

            <Style x:Uid="Style_17" x:Key="GridSplitterStyle" TargetType="{x:Type GridSplitter}">
                <Setter x:Uid="Setter_62" Property="Background" Value="{DynamicResource Brush.Background.Gray}"/>
                <Setter x:Uid="Setter_63" Property="Foreground" Value="{DynamicResource Brush.Item.Text.Black}"/>
                <Setter x:Uid="Setter_64" Property="BorderBrush" Value="{DynamicResource Brush.Item.Border}"/>
                <Setter x:Uid="Setter_65" Property="FocusVisualStyle" Value="{x:Null}"/>
            </Style>

            <Style x:Uid="Style_11" x:Key="ActionPaneEncryptSettingView.Shared.TextBlockStyle.SegoeUI.SemiBold.12px" TargetType="{x:Type TextBlock}">
                <Setter x:Uid="Setter_67" Property="FontFamily" Value="{StaticResource Shared.FontFamily.SegoeUI}"/>
                <Setter x:Uid="Setter_68" Property="FontWeight" Value="{StaticResource Shared.FontWeight.SemiBold}"/>
                <Setter x:Uid="Setter_69" Property="FontSize" Value="{StaticResource Shared.FontSize.12px}"/>
            </Style>

            <Style x:Uid="Style_12" x:Key="SelectRectangleStyle" TargetType="{x:Type Rectangle}">
                <Setter x:Uid="Setter_70" Property="Stroke" Value="{DynamicResource Brush.Item.SelectedBorder}"/>
                <Setter x:Uid="Setter_71" Property="Visibility" Value="Collapsed"/>
                <Style.Triggers>
                    <DataTrigger x:Uid="DataTrigger_1" Binding="{Binding Path=IsRectSelected}" Value="True">
                        <Setter x:Uid="Setter_72" Property="Visibility" Value="Visible" />
                        <Setter x:Uid="Setter_73" Property="StrokeThickness" Value="2" />
                        <Setter x:Uid="Setter_74" Property="Fill" Value="{DynamicResource Brush.PreviewPane.SelectedBackground}" />
                    </DataTrigger>
                    <DataTrigger x:Uid="DataTrigger_2" Binding="{Binding Path=IsRectSelecting}" Value="True">
                        <Setter x:Uid="Setter_75" Property="Visibility" Value="Visible" />
                        <Setter x:Uid="Setter_76" Property="StrokeThickness" Value="0.5" />
                        <Setter x:Uid="Setter_77" Property="Fill" Value="{DynamicResource Brush.PreviewPane.SelectingBackground}"/>
                    </DataTrigger>
                </Style.Triggers>
            </Style>

            <Style x:Uid="Style_13" x:Key="TreeViewExpandToggleButtonStyle" TargetType="{x:Type ToggleButton}">
                <Setter x:Uid="Setter_78" Property="Focusable" Value="False" />
                <Setter x:Uid="Setter_79" Property="Width" Value="18" />
                <Setter x:Uid="Setter_80" Property="Padding" Value="0" />
                <Setter x:Uid="Setter_132" Property="Margin" Value="4,0,0,0" />
                <Setter x:Uid="Setter_81" Property="Template">
                    <Setter.Value>
                        <ControlTemplate x:Uid="ControlTemplate_7" TargetType="{x:Type ToggleButton}">
                            <Grid x:Uid="Grid_3" Background="Transparent" SnapsToDevicePixels="True">
                                <Path x:Uid="arrow" x:Name="arrow"
                                      StrokeThickness="0"
                                      HorizontalAlignment="Left"
                                      VerticalAlignment="Center"
                                      Margin="{TemplateBinding Padding}"
                                      SnapsToDevicePixels="false" 
                                      Data="{DynamicResource Skin_DropDownIcon_Geometry}"
                                      Fill="{DynamicResource Brush.Bookmark.Expander}" 
                                      RenderTransformOrigin="0,1"
                                      Stretch="None"/>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger x:Uid="Trigger_9" Property="IsChecked" Value="True">
                                    <Setter x:Uid="Setter_82" Property="Data" TargetName="arrow" Value="{DynamicResource Skin_DownIcon_Geometry}" />
                                    <Setter x:Uid="Setter_133" Property="Width" Value="22" />
                                    <Setter x:Uid="Setter_134" Property="Margin" Value="0" />
                                </Trigger>
                                <Trigger x:Uid="Trigger_10" Property="IsEnabled" Value="False">
                                    <Setter x:Uid="Setter_83" Property="Opacity" Value="0.8" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <ControlTemplate x:Uid="ControlTemplate_8" x:Key="TreeViewItemTemplate" TargetType="{x:Type TreeViewItem}">
                <Grid x:Uid="SubGrid" x:Name="SubGrid" Margin="{TemplateBinding Padding}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition x:Uid="ColumnDefinition_1" Width="Auto" />
                        <ColumnDefinition x:Uid="ColumnDefinition_2" Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition x:Uid="RowDefinition_20" Height="Auto" />
                        <RowDefinition x:Uid="RowDefinition_21" Height="*" />
                    </Grid.RowDefinitions>

                    <ToggleButton x:Uid="Expander" x:Name="Expander" 
                                  ClickMode="Press" 
                                  Height="16" 
                                  Padding="2,0,0,0"
                                  Style="{StaticResource TreeViewExpandToggleButtonStyle}"
                                  IsChecked="{Binding Path=IsExpanded, RelativeSource={RelativeSource TemplatedParent}}" 
                                  Panel.ZIndex="1" />
                    <ContentPresenter x:Uid="PART_Header" Grid.Column="1" 
                                      KeyboardNavigation.DirectionalNavigation="Once" 
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                      TextBlock.Foreground="{DynamicResource Brush.Bookmark.Item.Text}"
                                      x:Name="PART_Header" 
                                      Content="{TemplateBinding Header}"
                                      ContentSource="Header" 
                                      ContentTemplate="{TemplateBinding HeaderTemplate}">
                        <ContentPresenter.Resources>
                            <Style x:Uid="Style_14" TargetType="{x:Type TextBlock}">
                                <Setter x:Uid="Setter_84" Property="TextTrimming" Value="CharacterEllipsis" />
                            </Style>
                        </ContentPresenter.Resources>
                    </ContentPresenter>

                    <ItemsPresenter x:Uid="ItemsHost" x:Name="ItemsHost" 
                                    Grid.Column="1" 
                                    Grid.Row="1" 
                                    KeyboardNavigation.DirectionalNavigation="Continue" />
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger x:Uid="Trigger_11" Property="IsExpanded" Value="False">
                        <Setter x:Uid="Setter_85" Property="Visibility" TargetName="ItemsHost" Value="Collapsed" />
                    </Trigger>
                    <Trigger x:Uid="Trigger_12" Property="HasItems" Value="False">
                        <Setter x:Uid="Setter_86" Property="Visibility" TargetName="Expander" Value="Hidden" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>

            <Style x:Uid="Style_15" x:Key="TreeViewItemContainerStyle" TargetType="{x:Type TreeViewItem}">
                <Setter x:Uid="Setter_87" Property="Padding" Value="0"/>
                <Setter x:Uid="Setter_88" Property="OverridesDefaultStyle" Value="True" />
                <Setter x:Uid="Setter_89" Property="HorizontalContentAlignment" Value="Stretch" />
                <Setter x:Uid="Setter_90" Property="Template" Value="{DynamicResource TreeViewItemTemplate}" />
                <Setter x:Uid="Setter_91" Property="KeyboardNavigation.DirectionalNavigation" Value="Continue" />
                <Setter x:Uid="Setter_92" Property="Focusable" Value="True" />
                <Setter x:Uid="Setter_93" Property="FocusVisualStyle" Value="{x:Null}" />
                <Setter x:Uid="Setter_139" Property="AutomationProperties.Name" Value="{Binding Converter={StaticResource AccessibleTextConverter}}"/>
            </Style>

            <HierarchicalDataTemplate x:Uid="HierarchicalDataTemplate_1" x:Key="SubBookmarkTreeTemplate" DataType="{x:Type controls:BookmarkTreeViewItem}" ItemsSource="{Binding BookmarkItems}">
                <controls:BookmarkItemControl x:Uid="controls:BookmarkItemControl_1" MinHeight="18" />
            </HierarchicalDataTemplate>
            <HierarchicalDataTemplate x:Uid="HierarchicalDataTemplate_2" x:Key="ToplevelBookmarkTreeTemplate" DataType="{x:Type controls:BookmarkTreeViewItem}" ItemsSource="{Binding BookmarkItems}" ItemTemplate="{StaticResource SubBookmarkTreeTemplate}">
                <controls:BookmarkItemControl x:Uid="controls:BookmarkItemControl_2" MinHeight="18"/>
            </HierarchicalDataTemplate>

            <Style x:Uid="Style_16" x:Key="BookmarkTreeViewStyle"
                   TargetType="{x:Type TreeView}">
                <Setter x:Uid="Setter_94" Property="ItemContainerStyle"
                        Value="{StaticResource TreeViewItemContainerStyle}" />
                <Setter x:Uid="Setter_95" Property="ItemTemplate"
                        Value="{StaticResource ToplevelBookmarkTreeTemplate}" />
                <Setter x:Uid="Setter_96" Property="Background" Value="Transparent" />
                <Setter x:Uid="Setter_97" Property="Template">
                    <Setter.Value>
                        <ControlTemplate x:Uid="ControlTemplate_9">
                            <Border x:Uid="Border_5" BorderThickness="0">
                                <controls:FlatScrollViewer x:Uid="controls:FlatScrollViewer_2"
                                                           Style="{StaticResource flatScrollViewer}"
                                                           VerticalScrollBarVisibility="Auto"
                                                           Tag="BookmarkScrollViewer"
                                                           HorizontalScrollBarVisibility="Disabled">
                                    <ItemsPresenter x:Uid="ItemsPresenter_2" />
                                </controls:FlatScrollViewer>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style x:Uid="Style_20" x:Key="ColorBlockStyle" TargetType="Button">
                <Setter x:Uid="Setter_112" Property="Margin" Value="2"/>
                <Setter x:Uid="Setter_113" Property="BorderBrush" Value="{DynamicResource Brush.Item.Border}"/>
                <Setter x:Uid="Setter_114" Property="Template">
                    <Setter.Value>
                        <ControlTemplate x:Uid="ControlTemplate_12" TargetType="Button">
                            <Grid x:Uid="Grid_9">
                                <Rectangle x:Uid="ColorRectangle" Name="ColorRectangle" Width="25" Height="25" StrokeThickness="1"
                                       Stroke="{Binding Path=BorderBrush, RelativeSource={RelativeSource FindAncestor, AncestorType=Button}}"
                                       Fill="{Binding Path=Background, RelativeSource={RelativeSource FindAncestor, AncestorType=Button}}">
                                </Rectangle>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger x:Uid="Trigger_13" Property="IsMouseOver" Value="True">
                                    <Setter x:Uid="Setter_115" Property="BorderBrush" Value="{DynamicResource Brush.HighLight.Color.Selected}"/>
                                    <Setter x:Uid="Setter_136" Property="StrokeThickness" TargetName="ColorRectangle" Value="2"/>
                                </Trigger>
                                <Trigger x:Uid="Trigger_15" Property="IsKeyboardFocused" Value="True">
                                    <Setter x:Uid="Setter_135" Property="BorderBrush" Value="{DynamicResource Brush.HighLight.Color.Selected}"/>
                                    <Setter x:Uid="Setter_137" Property="StrokeThickness" TargetName="ColorRectangle" Value="2"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style x:Uid="Style_21" x:Key="NoColorButtonStyle" TargetType="Button">
                <Setter x:Uid="Setter_104" Property="VerticalAlignment" Value="Center"/>
                <Setter x:Uid="Setter_105" Property="HorizontalAlignment" Value="Center"/>
                <Setter x:Uid="Setter_106" Property="Foreground" Value="{DynamicResource Brush.Item.Text.Gray}"/>
                <Setter x:Uid="Setter_107" Property="Background" Value="Transparent"/>
                <Setter x:Uid="Setter_108" Property="Template">
                    <Setter.Value>
                        <ControlTemplate x:Uid="ControlTemplate_11" TargetType="{x:Type Button}">
                            <Border x:Uid="Border_10" Background="{TemplateBinding Background}">
                                <ContentPresenter x:Uid="ContentPresenter_3" VerticalAlignment="Center" Margin="20,0,0,0"/>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger x:Uid="Trigger_14" Property="IsMouseOver" Value="True">
                        <Setter x:Uid="Setter_109" Property="Background" Value="{DynamicResource Brush.NoColorButton.Hover.Background}"/>
                        <Setter x:Uid="Setter_110" Property="Foreground" Value="{DynamicResource Brush.NoColorButton.Hover.Text}"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
            <Style x:Uid="Style_19" x:Key="ColorPopupContentStyle" TargetType="{x:Type ContentControl}">
                <Setter x:Uid="Setter_111" Property="ContentTemplate">
                    <Setter.Value>
                        <DataTemplate x:Uid="DataTemplate_2">
                            <Border x:Uid="Border_11" BorderBrush="{DynamicResource Brush.Item.Border}" BorderThickness="1" Background="{DynamicResource Brush.Background.White}">
                                <StackPanel x:Uid="StackPanel_17" Orientation="Vertical" Width="151" Height="Auto">
                                    <Border x:Uid="Border_12" BorderBrush="{DynamicResource Brush.Item.Border}" BorderThickness="0,0,0,1">
                                        <WrapPanel x:Uid="WrapPanel_1" Width="145" Height="Auto" Margin="2">
                                            <Button x:Uid="Button_1" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color1}" Tag ="0.7"/>
                                            <Button x:Uid="Button_2" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color2}" Tag ="0.7"/>
                                            <Button x:Uid="Button_3" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color3}" Tag ="0.7"/>
                                            <Button x:Uid="Button_4" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color4}" Tag ="0.7"/>
                                            <Button x:Uid="Button_5" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color5}" Tag ="0.7"/>
                                            <Button x:Uid="Button_6" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color6}" Tag ="0.7"/>
                                            <Button x:Uid="Button_7" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color7}" Tag ="0.7"/>
                                            <Button x:Uid="Button_8" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color8}" Tag ="0.7"/>
                                            <Button x:Uid="Button_9" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color9}" Tag ="0.7"/>
                                            <Button x:Uid="Button_10" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color10}" Tag ="0.7"/>
                                            <Button x:Uid="Button_11" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color11}" Tag ="0.7"/>
                                            <Button x:Uid="Button_12" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color12}" Tag ="0.7"/>
                                            <Button x:Uid="Button_13" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color13}" Tag ="0.7"/>
                                            <Button x:Uid="Button_14" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color14}" Tag ="0.7"/>
                                            <Button x:Uid="Button_15" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color15}" Tag ="0.7"/>
                                            <Button x:Uid="Button_16" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color16}"/>
                                            <Button x:Uid="Button_17" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color17}"/>
                                            <Button x:Uid="Button_18" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color18}"/>
                                            <Button x:Uid="Button_19" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color19}"/>
                                            <Button x:Uid="Button_20" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color20}"/>
                                            <Button x:Uid="Button_21" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color21}"/>
                                            <Button x:Uid="Button_22" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color22}"/>
                                            <Button x:Uid="Button_23" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color23}"/>
                                            <Button x:Uid="Button_24" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color24}"/>
                                            <Button x:Uid="Button_25" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color25}"/>
                                            <Button x:Uid="Button_26" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color26}"/>
                                            <Button x:Uid="Button_27" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color27}"/>
                                            <Button x:Uid="Button_28" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color28}"/>
                                            <Button x:Uid="Button_29" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color29}"/>
                                            <Button x:Uid="Button_30" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color30}"/>
                                            <Button x:Uid="Button_31" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color31}"/>
                                            <Button x:Uid="Button_32" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color32}"/>
                                            <Button x:Uid="Button_33" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color33}"/>
                                            <Button x:Uid="Button_34" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color34}"/>
                                            <Button x:Uid="Button_35" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color35}"/>
                                            <Button x:Uid="Button_36" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color36}"/>
                                            <Button x:Uid="Button_37" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color37}"/>
                                            <Button x:Uid="Button_38" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color38}"/>
                                            <Button x:Uid="Button_39" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color39}"/>
                                            <Button x:Uid="Button_40" Style="{StaticResource ColorBlockStyle}" Click="HighlightColor_Click" Background="{DynamicResource Brush.ColorGrid.Color40}"/>
                                        </WrapPanel>
                                    </Border>
                                    <StackPanel x:Uid="StackPanel_18" Margin="1">
                                        <Button x:Uid="NoColorButton" x:Name="NoColorButton"
                                            Content="No Color"
                                            Width="149"
                                            Height="25"
                                            Click="HighlightColor_Click"
                                            Style="{StaticResource NoColorButtonStyle}"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Uid="Style_22" x:Key="ImageViewerMainGridStyle" TargetType="Grid">
                <Setter x:Uid="Setter_116" Property="Background" Value="{DynamicResource Brush.PreviewPane.DarkBackground}"/>
                <Style.Triggers>
                    <DataTrigger x:Uid="DataTrigger_7" Binding="{Binding Path=PreviewPageImage}" Value="{x:Null}">
                        <Setter x:Uid="Setter_117" Property="Background" Value="{DynamicResource Brush.PreviewPane.WhiteBackground}"/>
                    </DataTrigger>
                </Style.Triggers>
            </Style>

            <Style x:Uid="Style_23" x:Key="TabControlStyle" TargetType="{x:Type TabControl}">
                <Setter x:Uid="Setter_118" Property="OverridesDefaultStyle" Value="True"/>
                <Setter x:Uid="Setter_119" Property="SnapsToDevicePixels" Value="True"/>
                <Setter x:Uid="Setter_120" Property="Template">
                    <Setter.Value>
                        <ControlTemplate x:Uid="ControlTemplate_13" TargetType="{x:Type TabControl}">
                            <Grid x:Uid="Grid_11" KeyboardNavigation.TabNavigation="Local">
                                <Grid.RowDefinitions>
                                    <RowDefinition x:Uid="RowDefinition_16" Height="Auto" />
                                    <RowDefinition x:Uid="RowDefinition_17" Height="*" />
                                </Grid.RowDefinitions>
                                <TabPanel x:Uid="HeaderPanel" x:Name="HeaderPanel"
                                          Grid.Row="0"
                                          Panel.ZIndex="1"
                                          Margin="0,0,4,-1"
                                          IsItemsHost="True"
                                          KeyboardNavigation.TabIndex="1"
                                          Background="Transparent" />
                                <Border x:Uid="Border_13" x:Name="Border"
                                        Grid.Row="1"
                                        BorderThickness="0,1,0,0"
                                        BorderBrush="{DynamicResource Brush.FakeRibbonTab.SeparatorBorder}"
                                        CornerRadius="2"
                                        KeyboardNavigation.TabNavigation="Local"
                                        KeyboardNavigation.DirectionalNavigation="Contained"
                                        KeyboardNavigation.TabIndex="2">
                                    <ContentPresenter x:Uid="PART_SelectedContentHost" x:Name="PART_SelectedContentHost"
                                                      ContentSource="SelectedContent" />
                                </Border>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Uid="Style_25" x:Key="CurPageTextBoxStyle" TargetType="TextBox">
                <Setter x:Uid="Setter_129" Property="FontFamily" Value="{StaticResource Shared.FontFamily.SegoeUI}"/>
                <Setter x:Uid="Setter_130" Property="FontWeight" Value="{StaticResource Shared.FontWeight.Normal}"/>
                <Setter x:Uid="Setter_131" Property="FontSize" Value="{StaticResource Shared.FontSize.12px}"/>
                <Setter x:Uid="Setter_122" Property="VerticalAlignment" Value="Center"/>
                <Setter x:Uid="Setter_123" Property="TextAlignment" Value="Right"/>
                <Setter x:Uid="Setter_138" Property="Template">
                    <Setter.Value>
                        <ControlTemplate x:Uid="ControlTemplate_14" TargetType="{x:Type TextBox}">
                            <Border x:Uid="border" x:Name="border" BorderThickness="1" CornerRadius="0"
                                BorderBrush="{DynamicResource Brush.SelectByNameDialog.FileNameTextBox.Border}">
                                <ScrollViewer x:Uid="PART_ContentHost" x:Name="PART_ContentHost"/>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Uid="Style_24" x:Key="PageTextBlockStyle" TargetType="TextBlock">
                <Setter x:Uid="Setter_124" Property="FontFamily" Value="{StaticResource Shared.FontFamily.SegoeUI}"/>
                <Setter x:Uid="Setter_125" Property="FontWeight" Value="{StaticResource Shared.FontWeight.Normal}"/>
                <Setter x:Uid="Setter_126" Property="FontSize" Value="{StaticResource Shared.FontSize.12px}"/>
                <Setter x:Uid="Setter_127" Property="VerticalAlignment" Value="Center"/>
                <Setter x:Uid="Setter_128" Property="TextWrapping" Value="NoWrap"/>
            </Style>

            <Style x:Uid="Style_26" x:Key="MovePageContentStyle" TargetType="{x:Type ContentControl}">
                <Setter x:Uid="Setter_148" Property="ContentTemplate">
                    <Setter.Value>
                        <DataTemplate x:Uid="DataTemplate_3">
                            <Border x:Uid="Border_14" Width="240"
                                    BorderBrush="{DynamicResource Brush.Item.Border}"
                                    BorderThickness="1"
                                    Background="{DynamicResource Brush.Background.White}">
                                <Grid x:Uid="Grid_16" Margin="10">
                                    <Grid.RowDefinitions>
                                        <RowDefinition x:Uid="RowDefinition_24" Height="Auto"/>
                                        <RowDefinition x:Uid="RowDefinition_25" Height="Auto"/>
                                        <RowDefinition x:Uid="RowDefinition_26" Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition x:Uid="ColumnDefinition_14" Width="Auto"/>
                                        <ColumnDefinition x:Uid="ColumnDefinition_15" Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock x:Uid="TextBlock_26" Grid.Row="0" Grid.Column="0" Margin="5" Text="Move:"/>
                                    <StackPanel x:Uid="StackPanel_22" Grid.Row="0" Grid.Column="1" Margin="5" Orientation="Vertical">
                                        <RadioButton x:Uid="BeforeRadioButton" x:Name="BeforeRadioButton"
                                                     Margin="5,0,0,5"
                                                     Content="Before"
                                                     IsTabStop="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsChecked}"
                                                     Style="{StaticResource FlatRadioButtonStyle}"/>
                                        <RadioButton x:Uid="AfterRadioButton" x:Name="AfterRadioButton"
                                                     Margin="5,0,0,5"
                                                     Content="After"
                                                     IsChecked="True"
                                                     IsTabStop="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsChecked}"
                                                     Style="{StaticResource FlatRadioButtonStyle}"/>
                                    </StackPanel>
                                    <TextBlock x:Uid="TextBlock_27" Grid.Row="1" Grid.Column="0" Margin="5" Text="Page:"/>
                                    <StackPanel x:Uid="StackPanel_23" Grid.Row="1" Grid.Column="1" Orientation="Horizontal">
                                        <controls:NumericUpDown x:Uid="numericUpDown" Margin="10,0,0,0" x:Name="numericUpDown"
                                                                Value="1" MaxValue="{Binding Path=Text, ElementName=PageNumberInTotal}" MinValue="1"/>
                                        <TextBlock x:Uid="TextBlock_28" Margin="3" Text="of"/>
                                        <TextBlock x:Uid="TextBlock_29" x:Name="PageNumberInTotal" Margin="0,3" Text="{Binding Path=Text, ElementName=TotalPageTextBlock}"/>
                                    </StackPanel>
                                    <Button x:Uid="MoveButton" x:Name="MoveButton" Grid.Row="2" Grid.Column="1"
                                            Margin="10,10,0,0" Width="80" Height="28"
                                            HorizontalAlignment="Right"
                                            Style="{StaticResource FlatBlueButtonStyle}"
                                            Click="MoveButton_Click"
                                            Content="Move"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Uid="Style_27" x:Key="SelectPagesTextBoxStyle" TargetType="TextBox">
                <Setter x:Uid="Setter_140" Property="FontFamily" Value="{StaticResource Shared.FontFamily.SegoeUI}"/>
                <Setter x:Uid="Setter_141" Property="FontWeight" Value="{StaticResource Shared.FontWeight.Normal}"/>
                <Setter x:Uid="Setter_142" Property="FontSize" Value="{StaticResource Shared.FontSize.13px}"/>
                <Setter x:Uid="Setter_143" Property="VerticalAlignment" Value="Center"/>
                <Setter x:Uid="Setter_152" Property="VerticalContentAlignment" Value="Center"/>
                <Setter x:Uid="Setter_144" Property="TextAlignment" Value="Left"/>
                <Setter x:Uid="Setter_145" Property="Template">
                    <Setter.Value>
                        <ControlTemplate x:Uid="ControlTemplate_15" TargetType="{x:Type TextBox}">
                            <Border x:Uid="Border_15" x:Name="border" BorderThickness="1" CornerRadius="0"
                                    BorderBrush="{DynamicResource Brush.Item.Border}">
                                <ScrollViewer x:Uid="ScrollViewer_1" x:Name="PART_ContentHost"/>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Uid="Style_28" x:Key="HideAndShowMainContentStyle" TargetType="Grid">
                <Setter x:Uid="Setter_146" Property="Visibility" Value="Hidden"/>
                <Style.Triggers>
                    <DataTrigger x:Uid="DataTrigger_8" Binding="{Binding Path=IsContextVisible}" Value="True">
                        <Setter x:Uid="Setter_147" Property="Visibility" Value="Visible"/>
                    </DataTrigger>
                </Style.Triggers>
            </Style>

            <Style x:Uid="Style_29" x:Key="CommentItemContainerStyle" TargetType="{x:Type ListViewItem}">
                <Setter x:Uid="Setter_153" Property="HorizontalContentAlignment" Value="Stretch" />
                <Setter x:Uid="Setter_154" Property="BorderThickness" Value="0"/>
                <Setter x:Uid="Setter_155" Property="SnapsToDevicePixels" Value="True" />
                <Setter x:Uid="Setter_156" Property="OverridesDefaultStyle" Value="True" />
                <Setter x:Uid="Setter_157" Property="Template">
                    <Setter.Value>
                        <ControlTemplate x:Uid="ControlTemplate_18" TargetType="{x:Type ListViewItem}">
                            <Grid x:Uid="Grid_19" HorizontalAlignment="Stretch"
                                  VerticalAlignment="Top">
                                <Border x:Uid="CommentItemBorder" x:Name="CommentItemBorder"
                                        BorderThickness="1"
                                        BorderBrush ="Transparent"/>
                                <ContentPresenter x:Uid="ContentPresenter_4" />
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger x:Uid="Trigger_17" Property="IsMouseOver" Value="True">
                                    <Setter x:Uid="Setter_158" TargetName="CommentItemBorder"
                                            Property="Background"
                                            Value="{DynamicResource Brush.Item.HoverBackground}" />
                                    <Setter x:Uid="Setter_159" TargetName="CommentItemBorder"
                                            Property="BorderBrush"
                                            Value="{DynamicResource Brush.Item.HoverBorder}" />
                                </Trigger>
                                <Trigger x:Uid="Trigger_18" Property="IsSelected" Value="True">
                                    <Setter x:Uid="Setter_160" TargetName="CommentItemBorder"
                                            Property="Background"
                                            Value="{DynamicResource Brush.Item.SelectedBackground}" />
                                    <Setter x:Uid="Setter_161" TargetName="CommentItemBorder"
                                            Property="BorderBrush"
                                            Value="{DynamicResource Brush.Item.SelectedBorder}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Uid="Style_30" x:Key="CommentListViewStyle" TargetType="{x:Type ListView}">
                <Setter x:Uid="Setter_162" Property="VirtualizingStackPanel.IsVirtualizing" Value="True" />
                <Setter x:Uid="Setter_163" Property="SnapsToDevicePixels" Value="True" />
                <Setter x:Uid="Setter_164" Property="Background" Value="Transparent" />
                <Setter x:Uid="Setter_165" Property="BorderThickness" Value="0"/>
                <Setter x:Uid="Setter_166" Property="Template">
                    <Setter.Value>
                        <ControlTemplate x:Uid="ControlTemplate_19">
                            <Border x:Uid="Border_18" BorderThickness="0">
                                <ScrollViewer x:Uid="controls:FlatScrollViewer_6"
                                              Style="{StaticResource noHideScrollViewer}"
                                              CanContentScroll="False"
                                              VerticalScrollBarVisibility="Auto"
                                              HorizontalScrollBarVisibility="Disabled">
                                    <ItemsPresenter x:Uid="ItemsPresenter_3" />
                                </ScrollViewer>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Uid="Style_31" x:Key="CommentListGroupContainStyle" TargetType="{x:Type GroupItem}">
                <Setter x:Uid="Setter_167" Property="Template">
                    <Setter.Value>
                        <ControlTemplate x:Uid="ControlTemplate_20">
                            <Grid x:Uid="Grid_20">
                                <Grid.RowDefinitions>
                                    <RowDefinition x:Uid="RowDefinition_28" Height="35"/>
                                    <RowDefinition x:Uid="RowDefinition_29" Height="Auto"/>
                                </Grid.RowDefinitions>

                                <Grid x:Uid="Grid_21" Grid.Row="0" Background="{DynamicResource Brush.FindButton.Backgroud}"
                                      MouseLeftButtonUp="CommentGroupGrid_MouseLeftButtonUp">
                                    <StackPanel x:Uid="StackPanel_27" Orientation="Horizontal"
                                                Margin="10,0"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Left">
                                        <TextBlock x:Uid="TextBlock_38" Text="{Binding Name}"
                                                   VerticalAlignment="Center"
                                                   Style="{StaticResource PageTextBlockStyle}"/>
                                    </StackPanel>
                                    <StackPanel x:Uid="StackPanel_28" Orientation="Horizontal"
                                                Margin="10,0"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Right">
                                        <TextBlock x:Uid="TextBlock_39" Text="("
                                                   VerticalAlignment="Center"
                                                   Style="{StaticResource PageTextBlockStyle}"/>
                                        <TextBlock x:Uid="TextBlock_40" Text="{Binding ItemCount}"
                                                   VerticalAlignment="Center"
                                                   Style="{StaticResource PageTextBlockStyle}"/>
                                        <TextBlock x:Uid="TextBlock_41" Text=")"
                                                   VerticalAlignment="Center"
                                                   Style="{StaticResource PageTextBlockStyle}"/>
                                    </StackPanel>
                                </Grid>
                                <ItemsPresenter x:Uid="ItemsPresenter_4" Grid.Row="1"/>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <DataTemplate x:Uid="DataTemplate_4" x:Key="CommentItemTemplate">
                <Grid x:Uid="CommentGrid" x:Name="CommentGrid"
                      Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition x:Uid="RowDefinition_30" Height="40"/>
                        <RowDefinition x:Uid="RowDefinition_31" Height="Auto"/>
                        <RowDefinition x:Uid="RowDefinition_32" Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Grid x:Uid="Grid_22" Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition x:Uid="ColumnDefinition_16" Width="Auto"/>
                            <ColumnDefinition x:Uid="ColumnDefinition_17" Width="*"/>
                            <ColumnDefinition x:Uid="ColumnDefinition_18" Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Rectangle x:Uid="CommentIcon" x:Name="CommentIcon"
                                   Grid.Column="0"
                                   Margin="5"
                                   Width="28" Height="28">
                            <Rectangle.Fill>
                                <DrawingBrush x:Uid="DrawingBrush_2" Stretch="Uniform">
                                    <DrawingBrush.Drawing>
                                        <DrawingGroup x:Uid="DrawingGroup_2">
                                            <DrawingGroup.Children>
                                                <GeometryDrawing x:Uid="GeometryDrawing_2" Brush="{Binding Path=ColorBrush}"
                                                                 Geometry="F1 M 2.66667,-9.53674e-007L 30.5893,-9.53674e-007C 32.0627,-9.53674e-007 33.256,1.19467 33.256,2.66667L 33.256,30.5893C 33.256,32.0627 32.0627,33.256 30.5893,33.256L 2.66667,33.256C 1.19467,33.256 0,32.0627 0,30.5893L 0,2.66667C 0,1.19467 1.19467,-9.53674e-007 2.66667,-9.53674e-007 Z "/>
                                                <GeometryDrawing x:Uid="GeometryDrawing_3" Brush="{DynamicResource Brush.Comment.Background.White}"
                                                                 Geometry="M 20.0493,16.268L 8.97333,16.268L 8.97333,17.5933L 20.0493,17.5933M 8.97333,12.0813L 24.7547,12.0813L 24.7547,13.4067L 8.97333,13.4067M 7.5,7.04133C 6.764,7.04133 6.16667,7.63867 6.16667,8.37467L 6.16667,22.3547C 6.16667,23.0893 6.764,23.688 7.5,23.688L 12.108,23.688L 12.108,28.712L 17.1333,23.688L 26.4,23.688C 27.1373,23.688 27.7333,23.0893 27.7333,22.3547L 27.7333,8.37467C 27.7333,7.63867 27.1373,7.04133 26.4,7.04133L 7.5,7.04133 Z "/>
                                            </DrawingGroup.Children>
                                        </DrawingGroup>
                                    </DrawingBrush.Drawing>
                                </DrawingBrush>
                            </Rectangle.Fill>
                        </Rectangle>
                        <TextBlock x:Uid="CommentUserTextBlock" x:Name="CommentUserTextBlock"
                                   Grid.Column="1"
                                   Margin="5"
                                   VerticalAlignment="Center"
                                   Text="{Binding User}"
                                   Style="{StaticResource PageTextBlockStyle}"/>
                        <TextBlock x:Uid="CommentModDateTextBlock" x:Name="CommentModDateTextBlock"
                                   Grid.Column="2"
                                   Margin="5"
                                   VerticalAlignment="Center"
                                   FontSize="10"
                                   Foreground="{DynamicResource Brush.Item.Text.Gray}"
                                   Text="{Binding ModifyDateString}"/>
                    </Grid>

                    <Grid x:Uid="Grid_23" Grid.Row="1">
                        <controls:PlaceholderTextBox x:Uid="CommentTextBox" x:Name="CommentTextBox"
                                                     Placeholder="Comment..."
                                                     Margin="10"
                                                     Height="28"
                                                     BorderBrush="{DynamicResource Brush.Item.Border}"
                                                     IsEnabled="{Binding Path=IsCommentOptionEnable}"
                                                     Foreground="{DynamicResource Brush.Item.Text.Black}"
                                                     Background="{DynamicResource Brush.Background.White}"
                                                     Visibility="{Binding IsInAddingMode, Converter={StaticResource bool2Vis}}"
                                                     KeyDown="CommentTextBox_KeyDown"
                                                     LostFocus="CommentTextBox_LostFocus"/>

                        <TextBlock x:Uid="CommentTextBlock" x:Name="CommentTextBlock"
                                   Grid.Column="1"
                                   Margin="10"
                                   VerticalAlignment="Center"
                                   Text="{Binding Content}"
                                   Visibility="{Binding IsInAddingMode, Converter={StaticResource invertBool2Vis}}"
                                   TextWrapping="Wrap"/>
                    </Grid>
                </Grid>
            </DataTemplate>

        </ResourceDictionary>
    </Window.Resources>

    <Grid x:Uid="Grid_4" x:Name="mainContent">
        <Grid.RowDefinitions>
            <RowDefinition x:Uid="RowDefinition_5" Height="Auto"/>
            <RowDefinition x:Uid="RowDefinition_6" Height="*"/>
            <RowDefinition x:Uid="RowDefinition_36" x:Name="UXNagBannerRow" Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition x:Uid="ColumnDefinition_3" x:Name="mainWindowsFirstColumn" Width="280" MinWidth="260"
                              MaxWidth="{Binding Path=ActualWidth, ElementName=PdfUtilViewWindow, Converter={StaticResource ValueAddition}, ConverterParameter='-400'}"/>
            <ColumnDefinition x:Uid="ColumnDefinition_4" Width="Auto"/>
            <ColumnDefinition x:Uid="ColumnDefinition_5" Width="*"/>
            <ColumnDefinition x:Uid="ColumnDefinition_6" Width="Auto"/>
            <ColumnDefinition x:Uid="mainWindowsLastColumn" x:Name="mainWindowsLastColumn"
                              MaxWidth="{Binding Path=ActualWidth, ElementName=PdfUtilViewWindow, Converter={StaticResource ValueAddition}, ConverterParameter='-400'}"/>
        </Grid.ColumnDefinitions>

        <StackPanel x:Uid="RibbonStackPanel" x:Name="RibbonStackPanel" HorizontalAlignment="Left" Grid.Row="0" Grid.RowSpan="1" Grid.Column="0" Grid.ColumnSpan="5" Orientation="Horizontal">
            <TabControl x:Uid="FakeRibbonTabControl" x:Name="FakeRibbonTabControl" Style="{StaticResource FakeRibbonTabStyle}" Width="{Binding Path=ActualWidth, ElementName=PdfUtilViewWindow}" Height="130">
                <TabItem x:Uid="TabItem_1" Header="Actions" Focusable="False" Style="{StaticResource FakeRibbonTabItemStyle}">
                    <StackPanel x:Uid="StackPanel_4" Background="Transparent" KeyboardNavigation.TabNavigation="Once">
                        <Grid x:Uid="Grid_5" Height="100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition x:Uid="ColumnDefinition_7" Width="Auto"/>
                                <ColumnDefinition x:Uid="ColumnDefinition_8" Width="Auto"/>
                                <ColumnDefinition x:Uid="ColumnDefinition_9" Width="Auto"/>
                                <ColumnDefinition x:Uid="ColumnDefinition_10" Width="Auto"/>
                                <ColumnDefinition x:Uid="ColumnDefinition_11" Width="Auto"/>
                                <ColumnDefinition x:Uid="ColumnDefinition_12" Width="Auto"/>
                                <ColumnDefinition x:Uid="ColumnDefinition_13" Width="Auto"/>
                                <ColumnDefinition x:Uid="ColumnDefinition_19" Width="Auto"/>
                                <ColumnDefinition x:Uid="ColumnDefinition_20" Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition x:Uid="RowDefinition_7" Height="*"/>
                                <RowDefinition x:Uid="RowDefinition_8" Height="Auto" />
                            </Grid.RowDefinitions>

                            <StackPanel x:Uid="StackPanel_5" Orientation="Horizontal" Grid.Row="0" Grid.RowSpan="1" Grid.Column="0" Grid.ColumnSpan="1">
                                <controls:ImageButton x:Uid="controls:ImageButton_1"
                                                      Margin="10,3,12,0"
                                                      ButtonText="Image(s)"
                                                      Tag="ExtractImagesButton"
                                                      AutomationProperties.Name="Image(s)"
                                                      Style="{StaticResource FakeRibbonLargeImageButtonStyle}"
                                                      ButtonPathSource="{StaticResource Skin_ExtractImagesIcon_Geometry}"
                                                      Command="{Binding Path=DataContext.FakeRibbonTabViewModel.ViewModelCommands.ExtractImagesCommand, ElementName=PdfUtilViewWindow}">
                                    <controls:ImageButton.ToolTip>
                                        <ToolTip x:Uid="ToolTip_1" Style="{StaticResource ButtonToolTip}">
                                            <TextBlock x:Uid="TextBlock_4" Style="{StaticResource ToolTipTextBlock}" 
                                                       Text="Extract the images from the selected pages in the PDF and save them into a specified folder."/>
                                        </ToolTip>
                                    </controls:ImageButton.ToolTip>
                                </controls:ImageButton>

                                <controls:ImageButton x:Uid="controls:ImageButton_2"
                                                      Margin="4,3,6,0"
                                                      ButtonText="Page(s)"
                                                      AutomationProperties.Name="Page(s)"
                                                      Style="{StaticResource FakeRibbonLargeImageButtonStyle}"
                                                      ButtonPathSource="{StaticResource Skin_ExtractPagesIcon_Geometry}"
                                                      Command="{Binding Path=DataContext.FakeRibbonTabViewModel.ViewModelCommands.ExtractPagesCommand, ElementName=PdfUtilViewWindow}">
                                    <controls:ImageButton.ToolTip>
                                        <ToolTip x:Uid="ToolTip_13" Style="{StaticResource ButtonToolTip}">
                                            <TextBlock x:Uid="TextBlock_16" Style="{StaticResource ToolTipTextBlock}" 
                                                       Text="Extract the selected pages to a new file in a specified folder. The new file can be one of a number of types including PDF and various Office file formats."/>
                                        </ToolTip>
                                    </controls:ImageButton.ToolTip>
                                </controls:ImageButton>
                            </StackPanel>

                            <TextBlock x:Uid="TextBlock_1" Grid.Row="1" Grid.RowSpan="1" Grid.Column="0" Grid.ColumnSpan="1"
                                       Margin="0,0,0,3"
                                       Text="Extract"
                                       TextAlignment="Center"
                                       TextWrapping="NoWrap"
                                       FontSize="{StaticResource Shared.FontSize.12px}"
                                       Foreground="{DynamicResource Brush.FakeRibbonGroupHeader.Text}"/>

                            <Border x:Uid="Border_6" Grid.Row="0" Grid.RowSpan="2"
                                    Grid.Column="1" Grid.ColumnSpan="1"
                                    Width="1"
                                    Margin="6,2,6,2"
                                    BorderThickness="0"
                                    SnapsToDevicePixels="True"
                                    Background="{DynamicResource Brush.FakeRibbonTab.SeparatorBorder}"/>

                            <StackPanel x:Uid="StackPanel_6" Orientation="Horizontal" Grid.Row="0" Grid.RowSpan="1" Grid.Column="2" Grid.ColumnSpan="1">
                                <controls:ImageButton x:Uid="controls:ImageButton_3"
                                                      Margin="4,3,12,0"
                                                      ButtonText="File(s)"
                                                      AutomationProperties.Name="File(s)"
                                                      Style="{StaticResource FakeRibbonLargeImageButtonStyle}"
                                                      ButtonPathSource="{StaticResource Skin_ImportFilesIcon_Geometry}"
                                                      Command="{Binding Path=DataContext.FakeRibbonTabViewModel.ViewModelCommands.ImportFilesCommand, ElementName=PdfUtilViewWindow}">
                                    <controls:ImageButton.ToolTip>
                                        <ToolTip x:Uid="ToolTip_14" Style="{StaticResource ButtonToolTip}">
                                            <TextBlock x:Uid="TextBlock_17" Style="{StaticResource ToolTipTextBlock}" 
                                                       Text="Insert the specified file(s) into the PDF file at the selected location. If a file is not a PDF, it will be converted to a PDF before the pages are inserted. The original file(s) being inserted will not be changed."/>
                                        </ToolTip>
                                    </controls:ImageButton.ToolTip>
                                </controls:ImageButton>

                                <controls:ImageButton x:Uid="controls:ImageButton_4"
                                                      Margin="4,3,12,0"
                                                      ButtonText="Camera"
                                                      Tag="CameraButton"
                                                      AutomationProperties.Name="Camera"
                                                      Style="{StaticResource FakeRibbonLargeImageButtonStyle}"
                                                      ButtonPathSource="{StaticResource Skin_ImportCameraIcon_Geometry}"
                                                      Command="{Binding Path=DataContext.FakeRibbonTabViewModel.ViewModelCommands.ImportFromCameraCommand, ElementName=PdfUtilViewWindow}">
                                    <controls:ImageButton.ToolTip>
                                        <ToolTip x:Uid="ToolTip_15" Style="{StaticResource ButtonToolTip}">
                                            <TextBlock x:Uid="TextBlock_18" Style="{StaticResource ToolTipTextBlock}" 
                                                       Text="Insert images from an attached camera or smart phone into the PDF file at the selected location. Each image will be inserted as a new PDF page."/>
                                        </ToolTip>
                                    </controls:ImageButton.ToolTip>
                                </controls:ImageButton>

                                <controls:ImageButton x:Uid="controls:ImageButton_5"
                                                      Margin="4,3,4,0"
                                                      ButtonText="Scanner"
                                                      Tag="ScannerButton"
                                                      AutomationProperties.Name="Scanner"
                                                      Style="{StaticResource FakeRibbonLargeImageButtonStyle}"
                                                      ButtonPathSource="{StaticResource Skin_ImportScannerIcon_Geometry}"
                                                      Command="{Binding Path=DataContext.FakeRibbonTabViewModel.ViewModelCommands.ImportFromScannerCommand, ElementName=PdfUtilViewWindow}">
                                    <controls:ImageButton.ToolTip>
                                        <ToolTip x:Uid="ToolTip_16" Style="{StaticResource ButtonToolTip}">
                                            <TextBlock x:Uid="TextBlock_19" Style="{StaticResource ToolTipTextBlock}" 
                                                       Text="Insert scanned pages into the PDF at the selected location. Each scanned page will be inserted as a new PDF page."/>
                                        </ToolTip>
                                    </controls:ImageButton.ToolTip>
                                </controls:ImageButton>
                            </StackPanel>

                            <TextBlock x:Uid="TextBlock_2" Grid.Row="1" Grid.RowSpan="1" Grid.Column="2" Grid.ColumnSpan="1"
                                       Margin="0,0,0,3"
                                       Text="Insert Pages From"
                                       TextAlignment="Center"
                                       TextWrapping="NoWrap"
                                       FontSize="{StaticResource Shared.FontSize.12px}"
                                       Foreground="{DynamicResource Brush.FakeRibbonGroupHeader.Text}"/>

                            <Border x:Uid="Border_7" Grid.Row="0" Grid.RowSpan="2"
                                    Grid.Column="3" Grid.ColumnSpan="1"
                                    Width="1"
                                    Margin="6,2,6,2"
                                    BorderThickness="0"
                                    SnapsToDevicePixels="True"
                                    Background="{DynamicResource Brush.FakeRibbonTab.SeparatorBorder}"/>

                            <StackPanel x:Uid="StackPanel_7" Orientation="Horizontal" Grid.Row="0" Grid.RowSpan="1" Grid.Column="4" Grid.ColumnSpan="1">
                                <controls:ImageButton x:Uid="controls:ImageButton_6"
                                                      Margin="4,3,12,0"
                                                      ButtonText="Lock PDF"
                                                      AutomationProperties.Name="Lock PDF"
                                                      Style="{StaticResource FakeRibbonLargeImageButtonStyle}"
                                                      ButtonPathSource="{StaticResource Skin_LockPDFIcon_Geometry}"
                                                      Command="{Binding Path=DataContext.FakeRibbonTabViewModel.ViewModelCommands.LockPdfCommand, ElementName=PdfUtilViewWindow}">
                                    <controls:ImageButton.ToolTip>
                                        <ToolTip x:Uid="ToolTip_17" Style="{StaticResource ButtonToolTip}">
                                            <TextBlock x:Uid="TextBlock_20" Style="{StaticResource ToolTipTextBlock}" 
                                                       Text="Lock the PDF to password-protect its contents and to optionally assign access permissions."/>
                                        </ToolTip>
                                    </controls:ImageButton.ToolTip>
                                </controls:ImageButton>

                                <controls:ImageButton x:Uid="controls:ImageButton_7"
                                                      Margin="4,3,12,0"
                                                      ButtonText="Unlock PDF"
                                                      AutomationProperties.Name="Unlock PDF"
                                                      Style="{StaticResource FakeRibbonLargeImageButtonStyle}"
                                                      ButtonPathSource="{StaticResource Skin_UnlockPDFIcon_Geometry}"
                                                      Command="{Binding Path=DataContext.FakeRibbonTabViewModel.ViewModelCommands.UnlockPdfCommand, ElementName=PdfUtilViewWindow}">
                                    <controls:ImageButton.ToolTip>
                                        <ToolTip x:Uid="ToolTip_18" Style="{StaticResource ButtonToolTip}">
                                            <TextBlock x:Uid="TextBlock_21" Style="{StaticResource ToolTipTextBlock}" 
                                                       Text="Unlock a locked PDF to remove password-protection from its contents and to remove any assigned access permissions."/>
                                        </ToolTip>
                                    </controls:ImageButton.ToolTip>
                                </controls:ImageButton>

                                <controls:ImageButton x:Uid="controls:ImageButton_8"
                                                      Margin="4,3,4,0"
                                                      ButtonText="Sign PDF"
                                                      AutomationProperties.Name="Sign PDF"
                                                      Style="{StaticResource FakeRibbonLargeImageButtonStyle}"
                                                      ButtonPathSource="{StaticResource Skin_SignPDFIcon_Geometry}"
                                                      Command="{Binding Path=DataContext.FakeRibbonTabViewModel.ViewModelCommands.SignPdfCommand, ElementName=PdfUtilViewWindow}">
                                    <controls:ImageButton.ToolTip>
                                        <ToolTip x:Uid="ToolTip_19" Style="{StaticResource ButtonToolTip}">
                                            <TextBlock x:Uid="TextBlock_22" Style="{StaticResource ToolTipTextBlock}" 
                                                       Text="Sign the PDF file to detect if it was modified after being signed. This ensures that a PDF has not been changed after signing and prior to receipt when the file is shared, or that a saved file was not altered after it was signed and saved."/>
                                        </ToolTip>
                                    </controls:ImageButton.ToolTip>
                                </controls:ImageButton>
                            </StackPanel>

                            <TextBlock x:Uid="TextBlock_3" Grid.Row="1" Grid.RowSpan="1" Grid.Column="4" Grid.ColumnSpan="1"
                                       Margin="0,0,0,3"
                                       Text="Security"
                                       TextAlignment="Center"
                                       TextWrapping="NoWrap"
                                       FontSize="{StaticResource Shared.FontSize.12px}"
                                       Foreground="{DynamicResource Brush.FakeRibbonGroupHeader.Text}"/>

                            <Border x:Uid="Border_8" Grid.Row="0" Grid.RowSpan="2"
                                    Grid.Column="5" Grid.ColumnSpan="1"
                                    Width="1"
                                    Margin="6,2,6,2"
                                    BorderThickness="0"
                                    SnapsToDevicePixels="True"
                                    Background="{DynamicResource Brush.FakeRibbonTab.SeparatorBorder}"/>

                            <StackPanel x:Uid="StackPanel_29" Orientation="Horizontal" Grid.Row="0" Grid.RowSpan="1" Grid.Column="6" Grid.ColumnSpan="1">
                                <controls:ImageButton x:Uid="controls:ImageButton_9"
                                                      Margin="4,3,4,0"
                                                      ButtonText="Add Signature"
                                                      AutomationProperties.Name="Add Signature"
                                                      ButtonBrushSource="{StaticResource SignatureDrawingBrush}"
                                                      Style="{StaticResource FakeRibbonLargeImageButtonStyle}"
                                                      Command="{Binding Path=DataContext.FakeRibbonTabViewModel.ViewModelCommands.SignatureCommand, ElementName=PdfUtilViewWindow}">
                                    <controls:ImageButton.ToolTip>
                                        <ToolTip x:Uid="ToolTip_24" Style="{StaticResource ButtonToolTip}">
                                            <TextBlock x:Uid="TextBlock_31" Style="{StaticResource ToolTipTextBlock}"
                                                       Text="Create a signature by typing or drawing on the document. To add a signature, click on the 'Add signature or initial' dropdown in the toolbar."/>
                                        </ToolTip>
                                    </controls:ImageButton.ToolTip>
                                </controls:ImageButton>
                            </StackPanel>

                            <TextBlock x:Uid="TextBlock_43" Grid.Row="1" Grid.RowSpan="1" Grid.Column="6" Grid.ColumnSpan="1"
                                       Margin="0,0,0,3"
                                       Text="Sign"
                                       TextAlignment="Center"
                                       TextWrapping="NoWrap"
                                       FontSize="{StaticResource Shared.FontSize.12px}"
                                       Foreground="{DynamicResource Brush.FakeRibbonGroupHeader.Text}"/>

                            <Border x:Uid="Border_19" Grid.Row="0" Grid.RowSpan="2"
                                    Grid.Column="7" Grid.ColumnSpan="1"
                                    Width="1"
                                    Margin="6,2,6,2"
                                    BorderThickness="0"
                                    SnapsToDevicePixels="True"
                                    Background="{DynamicResource Brush.FakeRibbonTab.SeparatorBorder}"/>

                            <StackPanel x:Uid="StackPanel_31" Orientation="Horizontal" Grid.Row="0" Grid.RowSpan="1" Grid.Column="8" Grid.ColumnSpan="1">
                                <controls:ImageButton x:Uid="controls:ImageButton_10"
                                                      Margin="4,3,4,0"
                                                      ButtonText="Comment"
                                                      AutomationProperties.Name="Comment"
                                                      ButtonBrushSource="{StaticResource CommentTitleDrawingBrush}"
                                                      Style="{StaticResource FakeRibbonLargeImageButtonStyle}"
                                                      Command="{Binding Path=DataContext.FakeRibbonTabViewModel.ViewModelCommands.CommentPdfCommand, ElementName=PdfUtilViewWindow}">
                                    <controls:ImageButton.ToolTip>
                                        <ToolTip x:Uid="ToolTip_29" Style="{StaticResource ButtonToolTip}">
                                            <TextBlock x:Uid="TextBlock_42" Style="{StaticResource ToolTipTextBlock}" 
                                                       Text="Show the comments in the document. To add a comment, please double-click in the preview pane."/>
                                        </ToolTip>
                                    </controls:ImageButton.ToolTip>
                                </controls:ImageButton>
                            </StackPanel>

                            <TextBlock x:Uid="TextBlock_45" Grid.Row="1" Grid.RowSpan="1" Grid.Column="8" Grid.ColumnSpan="1"
                                       Margin="0,0,0,3"
                                       Text="Annotate"
                                       TextAlignment="Center"
                                       TextWrapping="NoWrap"
                                       FontSize="{StaticResource Shared.FontSize.12px}"
                                       Foreground="{DynamicResource Brush.FakeRibbonGroupHeader.Text}"/>

                        </Grid>
                    </StackPanel>
                </TabItem>
            </TabControl>

        </StackPanel>

        <spl:StartupPane x:Uid="PdfStartupPane" x:Name="PdfStartupPane"
                         Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="5"
                         Visibility="{Binding Path=IsContextVisible, Converter={StaticResource invertBool2Vis}}"
                         DefaultAlready="{Binding AlreadySetDefault}"
                         DragInstructionText="Drag a file to open or multiple files to merge"
                         AppletName="WinZip PDF Express"
                         AppletIcon="/Resources/PdfUtil.ico"
                         DefaultAppFileType="PDF"
                         RecentFilesList="{Binding RecentList}"
                         SelectRecentFile="{Binding SelectFileInRecentList, Mode=TwoWay}"
                         DragEnter="PdfStartupPane_Drag"
                         DragOver="PdfStartupPane_Drag"
                         DragLeave="PdfStartupPane_Drag"
                         Drop="PdfStartupPane_Drop"
                         RecentFileOpen="PdfStartupPane_OpenFile"
                         ChooseFile="PdfStartupPane_ChooseFile"
                         SetAsDefault="PdfStartupPane_SetAsDefault"/>

        <Grid x:Uid="TabControlsStackGrid" x:Name="TabControlsStackGrid" HorizontalAlignment="Stretch" Grid.Column="0" Grid.Row="1">
            <TabControl x:Uid="TabControls" Name="TabControls" SelectionChanged="TabControls_SelectionChanged"
                        Visibility="{Binding Path=IsContextVisible, Converter={StaticResource bool2Vis}}"
                        BorderThickness="0" Style="{StaticResource TabControlStyle}">
                <TabItem x:Uid="ThumbnailsTab" x:Name="ThumbnailsTab" Header="Thumbnails" Style="{StaticResource TabItemStyle}" FontSize="{DynamicResource Shared.FontSize.13px}">
                    <Grid x:Uid="Grid_6" >
                        <Grid.RowDefinitions>
                            <RowDefinition x:Uid="RowDefinition_22" Height="Auto"/>
                            <RowDefinition x:Uid="RowDefinition_9" Height="Auto"/>
                            <RowDefinition x:Uid="RowDefinition_10" Height="*"/>
                        </Grid.RowDefinitions>

                        <TextBox x:Uid="SelectPagesDefaultTextBox" x:Name="SelectPagesDefaultTextBox"
                                 AutomationProperties.Name="Select Pages"
                                 Grid.Row="0" Height="28" Margin="8" Padding="5,0"
                                 Text="Select Pages"
                                 IsHitTestVisible="False"
                                 IsTabStop="False"
                                 Background="Transparent"
                                 Style="{StaticResource SelectPagesTextBoxStyle}"
                                 Foreground="{DynamicResource Brush.SharedStyle.FlatButtonBase.ButtonBorder}"
                                 Visibility="{Binding ElementName=SelectPagesTextBox, Path=Text, Converter={StaticResource string2VisInvert}}">
                        </TextBox>
                        <TextBox x:Uid="SelectPagesTextBox" x:Name="SelectPagesTextBox"
                                 AutomationProperties.Name="Selected Pages"
                                 Grid.Row="0" Height="28" Margin="8" Padding="5,0"
                                 PreviewTextInput="SelectPagesTextBox_PreviewTextInput"
                                 KeyDown="SelectPagesTextBox_KeyDown"
                                 Style="{StaticResource SelectPagesTextBoxStyle}"
                                 IsEnabled="{Binding Path=IsContextVisible}"
                                 Foreground="{DynamicResource Brush.Item.Text.Black}">
                        </TextBox>

                        <StackPanel x:Uid="StackPanel_9" Grid.Row="1">
                            <controls:FlatScrollViewer x:Uid="controls:FlatScrollViewer_3"
                                                       VerticalScrollBarVisibility="Disabled"
                                                       HorizontalScrollBarVisibility="Auto"
                                                       Style="{StaticResource flatToolBarScrollViewer}">
                                <controls:TouchScrollingStackPane x:Uid="controls:TouchScrollingStackPane_1">
                                    <StackPanel x:Uid="StackPanel_10" Orientation="Horizontal"
                                               HorizontalAlignment="Left"
                                               Margin="0,2,0,0"
                                               DockPanel.Dock="Left"
                                               Height="36">
                                        <controls:ImageButton x:Uid="WatermarkPageBtn"
                                                              x:Name="WatermarkPageBtn"
                                                              AutomationProperties.Name="Watermark Page(s)"
                                                              Tag="WatermarkPageBtn"
                                                              Style="{StaticResource ImageButtonStyle}"
                                                              Margin="10,0,0,0"
                                                              ButtonPathSource="{StaticResource Skin_WatermarkIcon_Geometry}"
                                                              Click="WatermarkPageBtn_Click">
                                            <controls:ImageButton.ToolTip>
                                                <ToolTip x:Uid="ToolTip_6" Style="{StaticResource ButtonToolTip}">
                                                    <TextBlock x:Uid="TextBlock_9" Style="{StaticResource ToolTipTextBlock}" 
                                                               Text="Watermark Page(s) - Add a custom watermark to the selected pages."/>
                                                </ToolTip>
                                            </controls:ImageButton.ToolTip>
                                        </controls:ImageButton>
                                        <controls:ImageButton x:Uid="MovePagesBtn"
                                                              x:Name="MovePagesBtn"
                                                              AutomationProperties.Name="Move Page(s)"
                                                              Tag="MovePagesBtn"
                                                              Style="{StaticResource ImageButtonStyle}"
                                                              Margin="8,0,0,0"
                                                              CommandParameter="False"
                                                              Command="{Binding Path=DataContext.ThumbnailPaneContextMenuViewModel.ViewModelCommands.MovePagesCommand, ElementName=PdfUtilViewWindow}"
                                                              ButtonPathSource="{StaticResource Skin_MovePageIcon_Geometry}">
                                            <controls:ImageButton.ToolTip>
                                                <ToolTip x:Uid="ToolTip_23" Style="{StaticResource ButtonToolTip}">
                                                    <TextBlock x:Uid="TextBlock_30" Style="{StaticResource ToolTipTextBlock}" 
                                                               Text="Move Page(s)- Move the selected page(s) to a different location in the PDF document."/>
                                                </ToolTip>
                                            </controls:ImageButton.ToolTip>
                                        </controls:ImageButton>
                                        <Popup x:Uid="MovePagesPopupWindow"
                                               x:Name="MovePagesPopupWindow"
                                               Placement="MousePoint"
                                               IsOpen="False"
                                               StaysOpen="False"
                                               KeyDown="MovePagesPopupWindow_KeyDown"
                                               MouseLeftButtonDown="MovePagesPopupWindow_MouseLeftButtonDown"
                                               Opened="MovePagesPopupWindow_Opened">
                                            <ContentControl x:Uid="ContentControl_1" x:Name="MovePagesPanel" IsTabStop="False" Style="{DynamicResource MovePageContentStyle}"/>
                                        </Popup>

                                        <controls:ImageButton x:Uid="RotatePageBtn"
                                                              x:Name="RotatePageBtn"
                                                              AutomationProperties.Name="Rotate Page(s)"
                                                              Tag="RotatePageBtn"
                                                              Style="{StaticResource ImageButtonStyle}"
                                                              Margin="8,0,0,0"
                                                              ButtonPathSource="{StaticResource Skin_RotatePageIcon_Geometry}"
                                                              Click="RotatePageBtn_Click">
                                            <controls:ImageButton.ToolTip>
                                                <ToolTip x:Uid="ToolTip_5" Style="{StaticResource ButtonToolTip}">
                                                    <TextBlock x:Uid="TextBlock_8" Style="{StaticResource ToolTipTextBlock}" 
                                                               Text="Rotate Page(s) - Rotate the selected pages 90, 180 or 270 degrees clockwise."/>
                                                </ToolTip>
                                            </controls:ImageButton.ToolTip>
                                        </controls:ImageButton>
                                        <controls:ImageButton x:Uid="DeletePagesBtn"
                                                              x:Name="DeletePagesBtn"
                                                              AutomationProperties.Name="Delete Page(s)"
                                                              Tag="DeletePagesBtn"
                                                              Style="{StaticResource ImageButtonStyle}"
                                                              Margin="8,0,0,0"
                                                              ButtonPathSource="{StaticResource Skin_DeletePageIcon_Geometry}"
                                                              Click="DeletePagesBtn_Click">
                                            <controls:ImageButton.ToolTip>
                                                <ToolTip x:Uid="ToolTip_3" Style="{StaticResource ButtonToolTip}">
                                                    <TextBlock x:Uid="TextBlock_6" Style="{StaticResource ToolTipTextBlock}" 
                                                               Text="Delete Page(s) - Delete the selected page(s) from the PDF file."/>
                                                </ToolTip>
                                            </controls:ImageButton.ToolTip>
                                        </controls:ImageButton>
                                        <controls:ImageButton x:Uid="DeleteBlankPagesBtn"
                                                              x:Name="DeleteBlankPagesBtn"
                                                              AutomationProperties.Name="Delete Blank Page(s)"
                                                              Tag="DeleteBlankPagesBtn"
                                                              Style="{StaticResource ImageButtonStyle}"
                                                              Margin="8,0,0,0"
                                                              ButtonPathSource="{StaticResource Skin_DeleteBlankPageIcon_Geometry}"
                                                              Click="DeleteBlankPagesBtn_Click">
                                            <controls:ImageButton.ToolTip>
                                                <ToolTip x:Uid="ToolTip_4" Style="{StaticResource ButtonToolTip}">
                                                    <TextBlock x:Uid="TextBlock_7" Style="{StaticResource ToolTipTextBlock}" 
                                                               Text="Delete Blank Page(s) - Delete all blank pages in the PDF file."/>
                                                </ToolTip>
                                            </controls:ImageButton.ToolTip>
                                        </controls:ImageButton>
                                        <controls:ImageButton x:Uid="AddBlankPageBtn"
                                                              x:Name="AddBlankPageBtn"
                                                              AutomationProperties.Name="Add Blank Page"
                                                              Tag="AddBlankPageBtn"
                                                              Style="{StaticResource ImageButtonStyle}"
                                                              Margin="8,0,0,0"
                                                              ButtonPathSource="{StaticResource Skin_AddBlankPageIcon_Geometry}"
                                                              Click="AddBlankPageBtn_Click">
                                            <controls:ImageButton.ToolTip>
                                                <ToolTip x:Uid="ToolTip_2" Style="{StaticResource ButtonToolTip}">
                                                    <TextBlock x:Uid="TextBlock_5" Style="{StaticResource ToolTipTextBlock}" 
                                                               Text="Add Blank Page - Insert a blank page at the selected location in the PDF file."/>
                                                </ToolTip>
                                            </controls:ImageButton.ToolTip>
                                        </controls:ImageButton>
                                        <controls:ImageButton x:Uid="SetBackGroundBtn"
                                                              x:Name="SetBackGroundBtn"
                                                              AutomationProperties.Name="Set Background Color"
                                                              Tag="SetBackGroundBtn"
                                                              Margin="8,0,10,0"
                                                              Style="{StaticResource ImageButtonStyle}"
                                                              ButtonPathSource="{StaticResource Skin_SetBackgroundColorIcon_Geometry}"
                                                              Click="SetBackGroundBtn_Click">
                                            <controls:ImageButton.ToolTip>
                                                <ToolTip x:Uid="ToolTip_20" Style="{StaticResource ButtonToolTip}">
                                                    <TextBlock x:Uid="TextBlock_23" Style="{StaticResource ToolTipTextBlock}" 
                                                               Text="Set Background Color - Change the background color of the selected page(s) in the PDF file."/>
                                                </ToolTip>
                                            </controls:ImageButton.ToolTip>
                                        </controls:ImageButton>
                                    </StackPanel>
                                </controls:TouchScrollingStackPane>
                            </controls:FlatScrollViewer>
                        </StackPanel>

                        <StackPanel x:Uid="StackPanel_16" Grid.Row="2">
                            <Separator x:Uid="Separator_1" Height="1" BorderBrush="{DynamicResource Brush.FakeRibbonTab.SeparatorBorder}"/>
                        </StackPanel>

                        <Grid x:Uid="ThumbnailListViewStackPanel" x:Name="ThumbnailListViewStackPanel"
                                   Grid.Row="2">
                            <Grid.RowDefinitions>
                                <RowDefinition x:Uid="RowDefinition_27" Height="*"/>
                                <RowDefinition x:Uid="RowDefinition_23" Height="40"/>
                            </Grid.RowDefinitions>
                            <Grid x:Uid="Grid_17" Grid.Row="0"
                                   ContextMenuOpening="ThumbnailStackPanel_ContextMenuOpening"
                                   ContextMenuClosing="ThumbnailListViewStackPanel_ContextMenuClosing"
                                   ContextMenu="{StaticResource ThumbnailPaneContextMenu}">
                                <utl:IconListView x:Uid="ThumbnailListView" x:Name="ThumbnailListView"
                                     AutomationProperties.Name="Page Thumbnails"
                                     Style="{StaticResource ListViewIconViewStyle}"
                                     BorderThickness="0"
                                     AllowDrop="True"
                                     Margin="0,3,0,0"
                                     SelectionMode="Extended"
                                     HorizontalAlignment="Center"
                                     DataContext="{Binding Path=DataContext.Icon, ElementName=PdfUtilViewWindow}"
                                     ItemsSource="{Binding Path=IconSources}"
                                     AlternationCount="{Binding Path=IconCount}"
                                     SelectionChanged="ThumbnailListView_SelectionChanged"
                                     DragEnter="ThumbnailListView_DragEnter"
                                     DragOver="ThumbnailListView_DragOver"
                                     DragLeave="ThumbnailListView_DragLeave"
                                     Drop="ThumbnailListView_Drop"
                                     PreviewMouseUp="ThumbnailListView_PreviewMouseUp"
                                     PreviewMouseMove="ThumbnailListView_PreviewMouseMove"
                                     PreviewMouseLeftButtonDown="ThumbnailListView_PreviewMouseLeftButtonDown"
                                     PreviewKeyDown="ThumbnailListView_PreviewKeyDown"
                                     PreviewStylusDown="ThumbnailListView_PreviewStylusDown"
                                     PreviewStylusMove="ThumbnailListView_PreviewStylusMove"
                                     Loaded="ThumbnailListView_Loaded"
                                     SizeChanged="ThumbnailListView_SizeChanged"/>
                            </Grid>

                            <Separator x:Uid="Separator_2" Grid.Row="1"
                                       Height="1" VerticalAlignment="Top"
                                       Visibility="{Binding Path=Visibility, ElementName=thumbnailSlider}"
                                       BorderBrush="{DynamicResource Brush.FakeRibbonTab.SeparatorBorder}" />
                            <StackPanel x:Uid="StackPanel_24" Orientation="Horizontal" HorizontalAlignment="Center"
                                        Grid.Row="1">
                                <RepeatButton x:Uid="sliderReductionButton" x:Name="sliderReductionButton"
                                            ToolTip="Zoom out"
                                            Click="sliderReductionButton_Click"
                                            BorderThickness="0"
                                            Visibility="{Binding Path=Visibility, ElementName=thumbnailSlider}"
                                            Background="Transparent"
                                            Width="16"
                                            Focusable="False"
                                            Height="16">
                                    <Path x:Uid="Path_2" Data="M0,0.5 L1,0.5"
                                            StrokeThickness="2"
                                            Stretch="Fill"
                                            Stroke="{DynamicResource Brush.Icon.BasicColor}" />
                                </RepeatButton>
                                <Slider x:Uid="thumbnailSlider" x:Name="thumbnailSlider"
                                        AutomationProperties.Name="Zoom Thumbnail"
                                        Margin="10, 0, 10, 0"
                                        Width="160"
                                        Height="20"
                                        Minimum="0.6"
                                        Maximum="8"
                                        Visibility="{Binding Path=DataContext.Icon.IconCount, ElementName=PdfUtilViewWindow, Converter={StaticResource int2Vis}}"
                                        Value="{Binding DataContext.ThumbnailZoom, ElementName=PdfUtilViewWindow}"
                                        IsSnapToTickEnabled="True"
                                        TickFrequency="0.02"
                                        ValueChanged="thumbnailSlider_ValueChanged"/>
                                <RepeatButton x:Uid="sliderIncreaseButton" x:Name="sliderIncreaseButton"
                                            ToolTip="Zoom in"
                                            Click="sliderIncreaseButton_Click"
                                            BorderThickness="0"
                                            Visibility="{Binding Path=Visibility, ElementName=thumbnailSlider}"
                                            Background="Transparent"
                                            Width="16"
                                            Focusable="False"
                                            Height="16">
                                    <Path x:Uid="Path_3" Data="M0.5,0 L0.5,1 M0,0.5 L1,0.5"
                                            StrokeThickness="2"
                                            Stretch="Fill"
                                            Stroke="{DynamicResource Brush.Icon.BasicColor}" />
                                </RepeatButton>
                            </StackPanel>
                        </Grid>
                    </Grid>
                </TabItem>

                <TabItem x:Uid="BookmarksTab" x:Name="BookmarksTab" Header="Bookmarks" Style="{StaticResource TabItemStyle}">
                    <Grid x:Uid="Grid_7">
                        <Grid.RowDefinitions>
                            <RowDefinition x:Uid="RowDefinition_11" Height="Auto"/>
                            <RowDefinition x:Uid="RowDefinition_12" Height="*"/>
                        </Grid.RowDefinitions>

                        <Grid x:Uid="Grid_12" Grid.Row="0">
                            <controls:FlatScrollViewer x:Uid="controls:FlatScrollViewer_4"
                                                       VerticalScrollBarVisibility="Disabled"
                                                       HorizontalScrollBarVisibility="Auto"
                                                       Style="{StaticResource flatToolBarScrollViewer}">
                                <controls:TouchScrollingStackPane x:Uid="controls:TouchScrollingStackPane_2">
                                    <StackPanel x:Uid="StackPanel_13" Orientation="Horizontal"
                                               HorizontalAlignment="Left"
                                               DockPanel.Dock="Left"
                                               Height="36">
                                        <controls:ImageButton x:Uid="AddBookmarkBtn"
                                                             x:Name="AddBookmarkBtn"
                                                             AutomationProperties.Name="Add a Bookmark"
                                                             Tag="AddBookmarkBtn"
                                                             IsEnabled="{Binding Path=IsBookmarkOptionEnable}"
                                                             Style="{StaticResource ImageButtonStyle}"
                                                             ButtonPathSource="{StaticResource Skin_AddBookmarkIcon_Geometry}"
                                                             Click="AddBookmarkBtn_Click">
                                            <controls:ImageButton.ToolTip>
                                                <ToolTip x:Uid="ToolTip_7" Style="{StaticResource ButtonToolTip}">
                                                    <TextBlock x:Uid="TextBlock_10" Style="{StaticResource ToolTipTextBlock}" 
                                                               Text="Add a Bookmark - Bookmark the top of the current page or selected page text and add it to the bookmark list with a specified name. Bookmarks are added to the bottom of the bookmarks list."/>
                                                </ToolTip>
                                            </controls:ImageButton.ToolTip>
                                        </controls:ImageButton>
                                        <controls:ImageButton x:Uid="AddSubBookmarkBtn"
                                                             x:Name="AddSubBookmarkBtn"
                                                             AutomationProperties.Name="Add a Sub-bookmark"
                                                             Tag="AddSubBookmarkBtn"
                                                             IsEnabled="{Binding Path=IsBookmarkOptionEnable}"
                                                             Style="{StaticResource ImageButtonStyle}"
                                                             Margin="8,0,0,0"
                                                             ButtonPathSource="{StaticResource Skin_AddSubBookmarkIcon_Geometry}"
                                                             Click="AddSubBookmarkBtn_Click">
                                            <controls:ImageButton.ToolTip>
                                                <ToolTip x:Uid="ToolTip_8" Style="{StaticResource ButtonToolTip}">
                                                    <TextBlock x:Uid="TextBlock_11" Style="{StaticResource ToolTipTextBlock}" 
                                                               Text="Add a Sub-bookmark - Select an existing bookmark to be a parent bookmark and then create a new named bookmark under the parent bookmark. Sub-bookmarks are ordered under the parent in the order the sub-bookmarks occur in the PDF file."/>
                                                </ToolTip>
                                            </controls:ImageButton.ToolTip>
                                        </controls:ImageButton>
                                        <controls:ImageButton x:Uid="RemoveBookmarkBtn"
                                                             x:Name="RemoveBookmarkBtn"
                                                             AutomationProperties.Name="Remove Bookmark"
                                                             Tag="RemoveBookmarkBtn"
                                                             IsEnabled="{Binding Path=IsBookmarkOptionEnable}"
                                                             Style="{StaticResource ImageButtonStyle}"
                                                             Margin="8,0,0,0"
                                                             ButtonPathSource="{StaticResource Skin_RemoveBookmarkIcon_Geometry}"
                                                             Click="RemoveBookmarkBtn_Click">
                                            <controls:ImageButton.ToolTip>
                                                <ToolTip x:Uid="ToolTip_9" Style="{StaticResource ButtonToolTip}">
                                                    <TextBlock x:Uid="TextBlock_12" Style="{StaticResource ToolTipTextBlock}" 
                                                               Text="Remove Bookmark - Select an existing bookmark and remove it from the list of bookmarks. If the bookmark is a parent bookmark, all sub-bookmarks below it are also removed."/>
                                                </ToolTip>
                                            </controls:ImageButton.ToolTip>
                                        </controls:ImageButton>
                                        <controls:ImageButton x:Uid="RenameBookmarkBtn"
                                                             x:Name="RenameBookmarkBtn"
                                                             AutomationProperties.Name="Rename Bookmark"
                                                             Tag="RenameBookmarkBtn"
                                                             IsEnabled="{Binding Path=IsBookmarkOptionEnable}"
                                                             Style="{StaticResource ImageButtonStyle}"
                                                             Margin="8,0,0,0"
                                                             ButtonPathSource="{StaticResource Skin_RenameBookmarkIcon_Geometry}"
                                                             Click="RenameBookmarkBtn_Click">
                                            <controls:ImageButton.ToolTip>
                                                <ToolTip x:Uid="ToolTip_10" Style="{StaticResource ButtonToolTip}">
                                                    <TextBlock x:Uid="TextBlock_13" Style="{StaticResource ToolTipTextBlock}" 
                                                               Text="Rename Bookmark - Change the name of the selected bookmark."/>
                                                </ToolTip>
                                            </controls:ImageButton.ToolTip>
                                        </controls:ImageButton>
                                    </StackPanel>
                                </controls:TouchScrollingStackPane>
                            </controls:FlatScrollViewer>
                        </Grid>

                        <StackPanel x:Uid="StackPanel_19" Grid.Row="1">
                            <Separator x:Uid="Separator_4" Height="1" BorderBrush="{DynamicResource Brush.FakeRibbonTab.SeparatorBorder}"/>
                        </StackPanel>

                        <Grid x:Uid="bookmarkPanel" Grid.Row="1" 
                                   KeyDown="bookmarkPanel_KeyDown"
                                   x:Name="bookmarkPanel"
                                   ContextMenu="{StaticResource BookmarkPaneContextMenu}">
                            <TreeView x:Uid="BookMarkTree" Style="{DynamicResource BookmarkTreeViewStyle}"
                                     AutomationProperties.Name="BookMarkTree"
                                     OverridesDefaultStyle="True"
                                     Margin="3,5,0,0"
                                     HorizontalAlignment="Stretch"
                                     ItemsSource="{Binding Path=DataContext.RootBookmarkTree.BookmarkItems, ElementName=PdfUtilViewWindow}"
                                     x:Name="BookMarkTree">
                            </TreeView>
                        </Grid>
                    </Grid>
                </TabItem>
            </TabControl>
        </Grid>

        <GridSplitter x:Uid="GridSplitter_1" Grid.Row="1" Grid.RowSpan="1" Grid.Column="1" Width="10" MaxWidth="10"
                      Visibility="{Binding Path=IsContextVisible, Converter={StaticResource bool2Vis}}"
                      HorizontalAlignment="Center" VerticalAlignment="Stretch"
                      Style="{StaticResource GridSplitterStyle}"
                      Template="{StaticResource LeftGridSplitterTemplate}"
                      Focusable="False"
                      Tag="LeftSplitter"
                      DragStarted="GridSplitter_DragStarted"
                      MouseEnter="GridSplitter_MouseEnter"
                      PreviewMouseLeftButtonDown="GridSplitter_PreviewMouseLeftButtonDown"
                      PreviewMouseLeftButtonUp="GridSplitter_PreviewMouseLeftButtonUp"/>

        <Grid x:Uid="Grid_8" x:Name="PreviewPanel"
              Grid.Row="1" Grid.RowSpan="1" Grid.Column="2"
              Style="{StaticResource HideAndShowMainContentStyle}"
              SizeChanged="PreviewPanel_SizeChanged">
            <Grid.RowDefinitions>
                <RowDefinition x:Uid="RowDefinition_13" Height="Auto"/>
                <RowDefinition x:Uid="RowDefinition_14" Height="Auto"/>
                <RowDefinition x:Uid="RowDefinition_15" Height="*"/>
            </Grid.RowDefinitions>
            <StackPanel x:Uid="StackPanel_14" Grid.Row="0">
                <controls:FlatScrollViewer x:Uid="controls:FlatScrollViewer_5"
                                           VerticalScrollBarVisibility="Disabled"
                                           HorizontalScrollBarVisibility="Auto"
                                           Style="{StaticResource flatScrollViewer}">
                    <controls:TouchScrollingStackPane x:Uid="controls:TouchScrollingStackPane_3" Orientation="Horizontal">
                        <StackPanel x:Name="ToolsStackPanel"
                                    x:Uid="StackPanel_15" Orientation="Horizontal"
                                    HorizontalAlignment="Left"
                                    Margin="16,2,0,0"
                                    DockPanel.Dock="Left"
                                    Height="36">
                            <controls:ImageButton x:Uid="FindBtn"
                                                  x:Name="FindBtn"
                                                  AutomationProperties.Name="Find"
                                                  Style="{StaticResource ImageButtonStyle}"
                                                  Margin="8,0,0,0"
                                                  ButtonPathSource="{StaticResource Skin_FindIcon_Geometry}"
                                                  Click="FindBtn_Click">
                                <controls:ImageButton.ToolTip>
                                    <ToolTip x:Uid="ToolTip_11" Style="{StaticResource ButtonToolTip}">
                                        <TextBlock x:Uid="TextBlock_14" Style="{StaticResource ToolTipTextBlock}" 
                                                   Text="Find - Search the PDF file for the specified text and display matches in the preview pane."/>
                                    </ToolTip>
                                </controls:ImageButton.ToolTip>
                            </controls:ImageButton>
                            <Grid x:Uid="Grid_10" Height="34" Width="34" Margin="8,0,0,0">
                                <controls:ImageToggleButton x:Uid="AddHighlightBtn"
                                                            x:Name="AddHighlightBtn"
                                                            AutomationProperties.Name="Add Highlight"
                                                            Style="{StaticResource ImageToggleButtonStyle}"
                                                            ButtonPathSource="{StaticResource Skin_HighlightIcon_Geometry}"
                                                            Click="AddHighlightBtn_Click"
                                                            MouseRightButtonDown="AddHighlightBtn_MouseRightButtonDown">
                                    <controls:ImageToggleButton.ToolTip>
                                        <ToolTip x:Uid="ToolTip_12" Style="{StaticResource ButtonToolTip}">
                                            <TextBlock x:Uid="TextBlock_15" Style="{StaticResource ToolTipTextBlock}"
                                                       Text="Highlight - Highlight the selected area in the preview pane with a chosen color. To remove a highlighted area, choose No Color."/>
                                        </ToolTip>
                                    </controls:ImageToggleButton.ToolTip>
                                </controls:ImageToggleButton>
                                <Rectangle x:Uid="HighlightColorPiece" x:Name="HighlightColorPiece" Height="2" Width="19" Margin="1,0,0,4" VerticalAlignment="Bottom" HorizontalAlignment="Left" Fill="Transparent"/>
                                <Popup x:Uid="HighlightColorPopupWindow"
                                       x:Name="HighlightColorPopupWindow"
                                       Placement="MousePoint"
                                       Opened="HighlightColorPopupWindow_Opened"
                                       IsOpen="False"
                                       StaysOpen="True">
                                    <ContentControl x:Uid="highlightPanel" x:Name="highlightPanel" Style="{DynamicResource ColorPopupContentStyle}"/>
                                </Popup>
                            </Grid>
                            <ComboBox x:Uid="ViewZoomInOutComboBox" x:Name="ViewZoomInOutComboBox"
                                      AutomationProperties.Name="Zoom In Out"
                                      Margin="8,0,0,0"
                                      Width="100" Height="26"
                                      HorizontalAlignment="Left"
                                      PreviewKeyDown="ViewZoomInOutComboBox_PreviewKeyDown"
                                      Style="{StaticResource ComboBoxFlatStyle}"
                                      SelectionChanged="ViewZoomInOutComboBox_SelectionChanged"/>
                            <controls:ImageButton x:Uid="PageUpBtn" x:Name="PageUpBtn"
                                                  AutomationProperties.Name="Page Up"
                                                  Margin="8,0,0,0"
                                                  Style="{StaticResource ImageButtonStyle}"
                                                  ButtonPathSource="{StaticResource Skin_PageUpIcon_Geometry}"
                                                  IsEnabled="{Binding Path=IsPageUpEnable}"
                                                  Click="PageUpBtn_Click">
                                <controls:ImageButton.ToolTip>
                                    <ToolTip x:Uid="ToolTip_21" Style="{StaticResource ButtonToolTip}">
                                        <TextBlock x:Uid="TextBlock_24" Style="{StaticResource ToolTipTextBlock}" 
                                                   Text="Page Up - Move back one page in the preview pane."/>
                                    </ToolTip>
                                </controls:ImageButton.ToolTip>
                            </controls:ImageButton>
                            <controls:ImageButton x:Uid="PageDownBtn" x:Name="PageDownBtn"
                                                  AutomationProperties.Name="Page Down"
                                                  Margin="4,0,0,0"
                                                  Style="{StaticResource ImageButtonStyle}"
                                                  ButtonPathSource="{StaticResource Skin_PageDownIcon_Geometry}"
                                                  IsEnabled="{Binding Path=IsPageDownEnable}"
                                                  Click="PageDownBtn_Click">
                                <controls:ImageButton.ToolTip>
                                    <ToolTip x:Uid="ToolTip_22" Style="{StaticResource ButtonToolTip}">
                                        <TextBlock x:Uid="TextBlock_25" Style="{StaticResource ToolTipTextBlock}" 
                                                   Text="Page Down - Move ahead one page in the preview pane."/>
                                    </ToolTip>
                                </controls:ImageButton.ToolTip>
                            </controls:ImageButton>
                            <StackPanel x:Uid="StackPanel_21" Orientation="Horizontal" Margin="8,0,0,0" Height="30">
                                <TextBox x:Uid="CurPageTextBox" x:Name="CurPageTextBox"
                                         Width="40"
                                         AutomationProperties.Name="Current page"
                                         Style="{StaticResource CurPageTextBoxStyle}"
                                         KeyDown="CurPageTextBox_KeyDown"
                                         LostFocus="CurPageTextBox_LostFocus"
                                         PreviewMouseDoubleClick="CurPageTextBox_PreviewMouseDoubleClick">
                                </TextBox>
                                <TextBlock x:Uid="PageSlashTextBlock" x:Name="PageSlashTextBlock"
                                           Style="{StaticResource PageTextBlockStyle}"
                                           Margin="4,0,4,0"
                                           Text="/"/>
                                <TextBlock x:Uid="TotalPageTextBlock" x:Name="TotalPageTextBlock"
                                           Style="{StaticResource PageTextBlockStyle}"
                                           Text="{Binding Path=TotalPageCount}"/>
                            </StackPanel>
                        </StackPanel>

                        <StackPanel x:Uid="SignatureStackPanel" x:Name="SignatureStackPanel"
                                    Orientation="Horizontal"
                                    Margin="16,2,0,0"
                                    Height="36"
                                    Visibility="{Binding Path=IsSignatureBarShow, Converter={StaticResource bool2Vis}}">
                            <TextBlock x:Uid="TextBlock_32" Text="Sign:"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"/>

                            <controls:SignatureComboBox x:Uid="SignComboBox" x:Name="SignComboBox" Margin="8,0,0,0"
                                                        Height="28"
                                                        SignatureList="{Binding SignatureList}"
                                                        SelectedSignature="{Binding SelectedSignature, Mode=TwoWay}"
                                                        SignatureSelected="SignComboBox_SignatureSelected"
                                                        AddSignature="SignComboBox_AddSignature"
                                                        DeleteSignature="SignComboBox_DeleteSignature"/>

                            <controls:ImageButton x:Uid="MarkYBtn"
                                                  x:Name="MarkYBtn"
                                                  AutomationProperties.Name="Mark Y"
                                                  Style="{StaticResource ImageButtonStyle}"
                                                  Margin="4,0,0,0"
                                                  ButtonBrushSource="{StaticResource MarkYDrawingBrush}"
                                                  Click="MarkYBtn_Click">
                                <controls:ImageButton.ToolTip>
                                    <ToolTip x:Uid="ToolTip_25" Style="{StaticResource ButtonToolTip}">
                                        <TextBlock x:Uid="TextBlock_33" Style="{StaticResource ToolTipTextBlock}"
                                                   Text="Add &#x2713; to your PDF."/>
                                    </ToolTip>
                                </controls:ImageButton.ToolTip>
                            </controls:ImageButton>

                            <controls:ImageButton x:Uid="MarkXBtn"
                                                  x:Name="MarkXBtn"
                                                  AutomationProperties.Name="Mark X"
                                                  Style="{StaticResource ImageButtonStyle}"
                                                  Margin="4,0,0,0"
                                                  Click="MarkXBtn_Click"
                                                  ButtonBrushSource="{StaticResource MarkXDrawingBrush}">
                                <controls:ImageButton.ToolTip>
                                    <ToolTip x:Uid="ToolTip_26" Style="{StaticResource ButtonToolTip}">
                                        <TextBlock x:Uid="TextBlock_34" Style="{StaticResource ToolTipTextBlock}"
                                                   Text="Add &#x2717; to your PDF."/>
                                    </ToolTip>
                                </controls:ImageButton.ToolTip>
                            </controls:ImageButton>
                        </StackPanel>
                    </controls:TouchScrollingStackPane>
                </controls:FlatScrollViewer>
            </StackPanel>

            <StackPanel x:Uid="StackPanel_20" Grid.Row="1" Visibility="Collapsed">
                <Separator x:Uid="Separator_3" Height="1" BorderBrush="{DynamicResource Brush.FakeRibbonTab.SeparatorBorder}"/>
            </StackPanel>

            <controls:FlatScrollViewer x:Uid="PreViewScrollViewer" x:Name="PreViewScrollViewer"
                                       VerticalScrollBarVisibility="Auto"
                                       HorizontalScrollBarVisibility="Auto"
                                       Grid.Row="2"
                                       Loaded="PreViewScrollViewer_Loaded"
                                       PreviewMouseWheel="PreViewScrollViewer_PreviewMouseWheel"
                                       ScrollChanged="PreViewScrollViewer_ScrollChanged"
                                       PreviewMouseLeftButtonDown ="PreViewScrollViewer_MouseLeftButtonDown"
                                       MouseLeftButtonUp="PreViewScrollViewer_MouseLeftButtonUp"
                                       MouseMove="PreViewScrollViewer_MouseMove"
                                       PreviewKeyDown="PreViewScrollViewer_PreviewKeyDown"
                                       ContextMenu="{StaticResource PreviewPaneContextMenu}"
                                       ContextMenuOpening="PreViewScrollView_ContextMenuOpening"
                                       Style="{StaticResource flatScrollViewer}">
                <Grid x:Uid="Grid_15"
                      x:Name="PreviewGrid"
                      Style="{StaticResource ImageViewerMainGridStyle}"
                      AllowDrop="True"
                      DragEnter="PreviewGrid_Drag"
                      DragOver="PreviewGrid_Drag"
                      DragLeave="PreviewGrid_Drag"
                      Drop="PreviewGrid_Drop">
                    <Grid x:Uid="ImageViewerGrid" x:Name="ImageViewerGrid"
                          HorizontalAlignment="Center"
                          Margin="1">
                        <Grid.LayoutTransform>
                            <TransformGroup x:Uid="TransformGroup_1">
                                <ScaleTransform x:Uid="scaleTransform" x:Name="scaleTransform"/>
                            </TransformGroup>
                        </Grid.LayoutTransform>

                        <Viewbox x:Uid="Viewbox_1" Grid.Row="0" Grid.Column="0">
                            <Border x:Uid="Border_9" BorderThickness="1">
                                <Grid x:Uid="PreviewScrollViewContent"
                                      x:Name="PreviewScrollViewContent"
                                      Width="Auto"
                                      Height="Auto"
                                      MouseLeftButtonDown="PreviewScrollViewContent_MouseLeftButtonDown"
                                      MouseLeftButtonUp="PreviewScrollViewContent_MouseLeftButtonUp"
                                      MouseRightButtonDown="PreviewScrollViewContent_MouseRightButtonDown"
                                      MouseMove="PreviewScrollViewContent_MouseMove">
                                    <Image x:Uid="PreviewImage" x:Name="PreviewImage"
                                           Source="{Binding Path=PreviewPageImage}"
                                           Visibility="{Binding Path=PreviewPageImage, Converter={StaticResource ContentToVisibilityConverter}}"
                                           RenderOptions.BitmapScalingMode="Fant"
                                           MouseRightButtonDown="PreviewImage_MouseRightButtonDown"/>
                                    <Canvas x:Uid="FormPersistenceCanvas" x:Name="FormPersistenceCanvas"
                                            Width="{Binding ElementName=PreviewImage, Path=ActualWidth}" 
                                            Height="{Binding ElementName=PreviewImage, Path=ActualHeight}"
                                            Visibility="{Binding Path=PreviewPageImage, Converter={StaticResource ContentToVisibilityConverter}}"/>
                                    <Canvas x:Uid="CommentCanvas" x:Name="CommentCanvas"
                                            Width="{Binding ElementName=PreviewImage, Path=ActualWidth}" 
                                            Height="{Binding ElementName=PreviewImage, Path=ActualHeight}"
                                            MouseLeftButtonDown="CommentCanvas_MouseLeftButtonDown"/>
                                    <Canvas x:Uid="textSearchCanvas" x:Name="textSearchCanvas">
                                        <Image x:Uid="Image_2"
                                               Source="{Binding Path=SearchCanvasImage}"
                                               Visibility="{Binding Path=SearchCanvasImage, Converter={StaticResource ContentToVisibilityConverter}}">
                                        </Image>
                                    </Canvas>
                                    <Canvas x:Uid="SignatureAddCanvas" x:Name="SignatureAddCanvas"
                                            Width="{Binding ElementName=PreviewImage, Path=ActualWidth}" 
                                            Height="{Binding ElementName=PreviewImage, Path=ActualHeight}"
                                            MouseLeftButtonDown="SignatureAddCanvas_MouseLeftButtonDown"
                                            MouseRightButtonDown="SignatureAddCanvas_MouseRightButtonDown"
                                            MouseMove="SignatureAddCanvas_MouseMove"
                                            MouseEnter="SignatureAddCanvas_MouseEnter">
                                    </Canvas>
                                    <Canvas x:Uid="FormEditCanvas" x:Name="FormEditCanvas"
                                            Visibility="Collapsed"
                                            Width="{Binding ElementName=PreviewImage, Path=ActualWidth}" 
                                            Height="{Binding ElementName=PreviewImage, Path=ActualHeight}">
                                    </Canvas>
                                    <Canvas x:Uid="SelectRectCanvas" x:Name="SelectRectCanvas"
                                            Width="{Binding ElementName=PreviewImage, Path=ActualWidth}" 
                                            Height="{Binding ElementName=PreviewImage, Path=ActualHeight}"
                                            MouseRightButtonDown="SelectRectCanvas_MouseRightButtonDown"
                                            ContextMenu="{StaticResource PreviewPaneSelectedRectContextMenu}"
                                            ContextMenuOpening="SelectRectCanvas_ContextMenuOpening">
                                        <Rectangle x:Uid="SelectRectangle" x:Name="SelectRectangle" 
                                                   Style="{StaticResource ResourceKey=SelectRectangleStyle}"
                                                   Width="{Binding Path=SelectRectSize.X}"
                                                   Height="{Binding Path=SelectRectSize.Y}"
                                                   Canvas.Left="{Binding Path=SelectRectLeftTopPoint.X}"
                                                   Canvas.Top="{Binding Path=SelectRectLeftTopPoint.Y}">
                                        </Rectangle>
                                    </Canvas>
                                </Grid>
                            </Border>
                        </Viewbox>
                    </Grid>
                </Grid>
            </controls:FlatScrollViewer>
            <controls:FindReplaceControl x:Uid="findReplaceControl"
                                         Grid.Row="2"
                                         MouseLeftButtonDown="findReplaceControl_MouseLeftButtonDown"
                                         Visibility="Hidden"
                                         x:Name="findReplaceControl"
                                         Margin="0,0,18,0"
                                         VerticalAlignment="Top"
                                         HorizontalAlignment="Right"/>
            <Grid x:Uid="loadingGrid"
                  Width="{Binding Path=ActualWidth, ElementName=PreviewPanel}"
                  Height="{Binding Path=ActualHeight, ElementName=PreviewPanel}"
                  x:Name="loadingGrid"
                  Visibility="Hidden"
                  Grid.Row="0"
                  Grid.RowSpan="3">
                <Image x:Uid="Image_1"
                       x:Name="LoadingGif"
                       Width="150"
                       Height="150"
                       Stretch="Uniform"/>
            </Grid>
        </Grid>

        <GridSplitter x:Uid="GridSplitter_2" Grid.Row="1" Grid.RowSpan="1" Grid.Column="3"
                      Width="10" MaxWidth="10"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Stretch"
                      Visibility="{Binding Path=IsContextVisible, Converter={StaticResource bool2Vis}}"
                      Style="{StaticResource GridSplitterStyle}"
                      Template="{StaticResource RightGridSplitterTemplate}"
                      Focusable="False"
                      Tag="RightSplitter"
                      DragStarted="GridSplitter_DragStarted"
                      MouseEnter="GridSplitter_MouseEnter"
                      PreviewMouseLeftButtonDown="GridSplitter_PreviewMouseLeftButtonDown"
                      PreviewMouseLeftButtonUp="GridSplitter_PreviewMouseLeftButtonUp">
        </GridSplitter>

        <Grid x:Uid="CommentControlsGrid" x:Name="CommentControlsGrid" Grid.Row="1" Grid.RowSpan="1" Grid.Column="4">
            <Grid.Visibility>
                <MultiBinding x:Uid="MultiBinding_1" Converter="{StaticResource bool2VisMulti}">
                    <Binding x:Uid="Binding_1" ElementName="PdfUtilViewWindow" Path="DataContext.IsContextVisible"/>
                    <Binding x:Uid="Binding_2" ElementName="PdfUtilViewWindow" Path="DataContext.IsCommentPaneShow"/>
                </MultiBinding>
            </Grid.Visibility>
            <Grid.RowDefinitions>
                <RowDefinition x:Uid="RowDefinition_33" Height="Auto"/>
                <RowDefinition x:Uid="RowDefinition_34" Height="Auto"/>
                <RowDefinition x:Uid="RowDefinition_35" Height="*"/>
            </Grid.RowDefinitions>

            <TextBlock x:Uid="CommentTitle" x:Name="CommentTitle"
                       Grid.Row="0"
                       Margin="10"
                       Text="{Binding PageCommentTitle}"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Left"
                       Style="{StaticResource PageTextBlockStyle}"/>

            <StackPanel x:Uid="FilterCommentPanel" x:Name="FilterCommentPanel" Grid.Row="1">
                <controls:PlaceholderTextBox x:Uid="SearchCommentTextbox" x:Name="SearchCommentTextbox"
                                             Placeholder="Search"
                                             Margin="10,0"
                                             Height="28"
                                             BorderBrush="{DynamicResource Brush.Item.Border}"
                                             IsEnabled="{Binding Path=IsCommentOptionEnable}"
                                             Foreground="{DynamicResource Brush.Item.Text.Black}"
                                             Background="{DynamicResource Brush.Background.White}"
                                             TextBox.TextChanged="SearchCommentTextbox_TextChanged"/>

                <Grid x:Uid="Grid_24" Margin="10,15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition x:Uid="ColumnDefinition_23" Width="Auto"/>
                        <ColumnDefinition x:Uid="ColumnDefinition_24" Width="*"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock x:Uid="TextBlock_44"
                               Grid.Column="0"
                               Text="Sort:"
                               VerticalAlignment="Center"
                               Style="{StaticResource PageTextBlockStyle}"/>
                    <ComboBox x:Uid="CommentSortComboBox" x:Name="CommentSortComboBox"
                              Grid.Column="1"
                              AutomationProperties.Name="Sort Comments"
                              Margin="10,0,0,0"
                              Height="28"
                              VerticalAlignment="Center"
                              Style="{StaticResource ComboBoxFlatStyle}"
                              IsEnabled="{Binding Path=IsCommentOptionEnable}"
                              SelectionChanged="CommentSortComboBox_SelectionChanged"/>
                </Grid>
            </StackPanel>

            <Grid x:Uid="CommentPanel" x:Name="CommentPanel" Grid.Row="2">
                <TextBlock x:Uid="CommentNotFoundText" x:Name="CommentNotFoundText"
                           Margin="10"
                           Text="No results found."
                           IsEnabled="False"
                           Style="{StaticResource NormalTextBlockStyle}"
                           Visibility="{Binding IsSearchCommentNotFound, Converter={StaticResource bool2Vis}}"/>

                <ListView x:Uid="CommentList" x:Name="CommentList"
                          AutomationProperties.Name="Comments"
                          Margin="0,5,0,0"
                          SelectionMode="Single"
                          SelectedItem="{Binding SelectedCommentItem}"
                          Style="{StaticResource CommentListViewStyle}"
                          ItemContainerStyle="{StaticResource CommentItemContainerStyle}"
                          ItemTemplate="{StaticResource CommentItemTemplate}"
                          ItemsSource="{Binding CommentItems}"
                          SelectionChanged="CommentList_SelectionChanged"
                          Visibility="{Binding IsSearchCommentNotFound, Converter={StaticResource invertBool2Vis}}">
                    <ListView.GroupStyle>
                        <GroupStyle x:Uid="GroupStyle_1" ContainerStyle="{StaticResource CommentListGroupContainStyle}" />
                    </ListView.GroupStyle>
                </ListView>
            </Grid>
        </Grid>

        <Frame x:Uid="NagBannerFrame" x:Name="NagBannerFrame"
               Grid.Row="2"
               Grid.Column="0"
               Grid.ColumnSpan="5"
               IsTabStop="False"
               TabIndex="1000"
               Height="40"
               NavigationUIVisibility="Hidden"/>
    </Grid>
</controls:BaseWindow>

